filter(surface_temp_min > 0) %>%
ggplot(., aes(x = month, y = surface_temp_median, color = year)) +
geom_point() +
geom_point() +
final_theme +
labs(x = 'day of year',
y = 'median whole-lake surface temperature (deg C)')
View(insitu_2018)
read_csv(paste0(datadir, 'temp_sunapee_paired_2021_0428.csv'),
col_types = c('')) %>%
mutate(date =as.Date(substrRight(`system:index`, 8), '%Y%m%d'))
lst_paired <- read_csv(paste0(datadir, 'temp_sunapee_paired_2021_0428.csv'),
col_types = c('')) %>%
mutate(date =as.Date(substrRight(`system:index`, 8), '%Y%m%d')) %>%
select(date, avg_temp:count)
lst_unimodal %>%
left_join(., lst_paired)
lst_unimodal %>%
left_join(., lst_paired) %>%
filter(count >0)
validation <- lst_unimodal %>%
left_join(., lst_paired) %>%
filter(count >0)
validation_ls <- lm(validation$surface_temp_mean ~ validation$avg_temp)
summary(validation_ls)
validation_dem <-deming::deming(validation$surface_temp_mean ~ validation$avg_temp)
validation_dem
cor(validation$surface_temp_mean, validation$avg_temp)
ggplot(validation, aes(x = avg_temp, y = surface_temp_mean)) +
geom_point() +
geom_abline(intercept = validation_dem$coefficients[1], slope = validation_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = validation_dem$ci[1,1], slope = validation_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = validation_dem$ci[1,2], slope = validation_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
labs(y = 'satellite-derived mean LST (deg C)',
x = 'in-situ mean water temp (deg C)') +
final_theme
#and with error
validation <- validation %>%
mutate(insitu_se = t_std_dev/sqrt(count),
lst_se = surface_temp_stdDev/sqrt(pixel_count))
ggplot(validation, aes(x = avg_temp, y = surface_temp_mean, color = cloud_cover)) +
geom_point()
ggplot(validation, aes(x = avg_temp, y = surface_temp_mean)) +
geom_point() +
geom_abline(intercept = validation_dem$coefficients[1], slope = validation_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = validation_dem$ci[1,1], slope = validation_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = validation_dem$ci[1,2], slope = validation_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
labs(y = 'satellite-derived mean LST (deg C)',
x = 'in-situ mean water temp (deg C)') +
final_theme
View(lst_unimodal)
View(validation)
ggplot(val_mean, aes(x = avg_temp, y = surface_temp_mean)) +
geom_point() +
geom_abline(intercept = val_mean_dem$coefficients[1], slope = val_mean_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem$ci[1,1], slope = val_mean_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem$ci[1,2], slope = val_mean_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(0,30),
ylim = c(0,30)) +
labs(y = 'satellite-derived mean LST (deg C)',
x = 'in-situ mean water temp (deg C)') +
final_theme
val_mean_ls <- lm(val_mean$surface_temp_mean ~ val_mean$avg_temp)
summary(val_mean_ls)
val_mean_ls <- lm(validation$surface_temp_mean ~ validation$avg_temp)
summary(val_mean_ls)
val_mean_dem <-deming::deming(validation$surface_temp_mean ~ validation$avg_temp)
val_mean_dem
cor(validation$surface_temp_mean, validation$avg_temp)
ggplot(validation, aes(x = avg_temp, y = surface_temp_mean)) +
geom_point() +
geom_abline(intercept = val_mean_dem$coefficients[1], slope = val_mean_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem$ci[1,1], slope = val_mean_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem$ci[1,2], slope = val_mean_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(0,30),
ylim = c(0,30)) +
labs(y = 'satellite-derived mean LST (deg C)',
x = 'in-situ mean water temp (deg C)') +
final_theme
ggplot(validation, aes(x = avg_temp, y = surface_temp_mean)) +
geom_point() +
geom_abline(intercept = val_mean_dem$coefficients[1], slope = val_mean_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem$ci[1,1], slope = val_mean_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem$ci[1,2], slope = val_mean_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(2,27),
ylim = c(2,27)) +
labs(y = 'satellite-derived mean LST (deg C)',
x = 'in-situ mean water temp (deg C)') +
final_theme
ggsave(paste0(dir, 'figures/deming_reg_average_val_mean_v17May2021.jpg'), height = 5, width = 5, units = 'in')
ggsave(paste0(figdir, 'deming_reg_average_val_mean_v17May2021.jpg'), height = 5, width = 5, units = 'in')
val_mean_ls <- lm(validation$surface_temp_mean ~ validation$avg_temp)
summary(val_mean_ls)
val_mean_dem <-deming::deming(validation$surface_temp_mean ~ validation$avg_temp)
val_mean_dem
cor(validation$surface_temp_mean, validation$avg_temp)
ggplot(validation, aes(x = avg_temp, y = surface_temp_mean)) +
geom_point() +
geom_abline(intercept = val_mean_dem$coefficients[1], slope = val_mean_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem$ci[1,1], slope = val_mean_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem$ci[1,2], slope = val_mean_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(2,27),
ylim = c(2,27)) +
labs(y = 'satellite-derived mean LST (deg C)',
x = 'in-situ mean water temp (deg C)') +
final_theme
ggsave(paste0(figdir, 'deming_reg_average_val_mean_v17May2021.jpg'), height = 5, width = 5, units = 'in')
lst_insitu_dem_forresid = mcreg(x = validation$avg_temp, y = validation$surface_temp_mean, method.reg = 'Deming')
validation$opt_resid = MCResult.getResiduals(lst_insitu_dem_forresid)$optimized
ggplot(lst_insitu, aes(sample = opt_resid)) +
geom_qq() +
geom_qq_line()
ggplot(validation, aes(sample = opt_resid)) +
geom_qq() +
geom_qq_line()
ggplot(lst_insitu, aes (y = opt_resid, x = avg_temp)) +
geom_point() +
labs(x = 'in-situ mean water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = avg_temp)) +
geom_point() +
labs(x = 'in-situ mean water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = avg_temp, color = month)) +
geom_point(size = 2) +
labs(x = 'in-situ mean water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_x_colorbymonth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = avg_temp)) +
geom_point() +
labs(x = 'in-situ mean water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = cloud_cover)) +
geom_point() +
labs(x = 'cloud cover (percent)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_cloudcover_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = cloud_cover, color = month)) +
geom_point(size = 2) +
labs(x = 'cloud cover (percent)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_cloudcover_colorbymonth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = pixel_count)) +
geom_point() +
labs(x = 'pixel count',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_pixelcount_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = pixel_count, color = month)) +
geom_point(size = 2) +
labs(x = 'pixel count',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_pixelcount_colorbymonth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = avg_depth)) +
geom_point() +
labs(x = 'mean in-situ depth (m)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_insitudepth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = avg_depth, color = month)) +
geom_point(size = 2) +
labs(x = 'mean in-situ depth (m)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_insitudepth_colorbymonth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = month)) +
geom_point() +
labs(x = 'month',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_month_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = month)) +
geom_point() +
labs(x = 'month',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = month, color = pixel_count)) +
geom_point(size = 2) +
labs(x = 'month',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = month, color = cloud_cover)) +
geom_point(size = 2) +
labs(x = 'month',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = year)) +
geom_point() +
labs(x = 'year',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = year)) +
geom_point() +
labs(x = 'year',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = year, color = pixel_count)) +
geom_point(size = 2) +
labs(x = 'year',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = year, color = cloud_cover)) +
geom_point(size = 2) +
labs(x = 'year',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = doy)) +
geom_point() +
labs(x = 'doy',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = doy, color = pixel_count)) +
geom_point(size = 2) +
labs(x = 'doy',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation, aes (y = opt_resid, x = doy, color = cloud_cover)) +
geom_point(size = 2) +
labs(x = 'doy',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
cor_pixel_doy = round(cor(x = validation$pixel_count, y = validation$doy), digits = 2)
pixel_doy <- ggplot(validation, aes(x = pixel_count, y = doy)) +
geom_point() +
geom_text(label = paste0('r = ', cor_pixel_doy), aes(y = 125, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='day of year') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
cor_pixel_cloud = round(cor(x = validation$pixel_count, y = validation$cloud_cover), digits = 2)
cor_pixel_cloud = '-0.50' #save as character for digit resolution
pixel_cloud <- ggplot(validation, aes(x = pixel_count, y = cloud_cover)) +
geom_point() +
geom_text(label = paste0('r = ', cor_pixel_cloud), aes(y = 0, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
cor_doy_cloud = round(cor(x = validation$doy, y = validation$cloud_cover), digits = 2)
doy_cloud <- ggplot(validation, aes(x = doy, y = cloud_cover)) +
geom_point() +
geom_text(label = paste0('r = ', cor_doy_cloud), aes(y = 0, x = 275)) +
labs(x = 'day of year\n', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
plot_grid(pixel_doy, pixel_cloud, doy_cloud, labels = c('a', 'b', 'c'), nrow = 1)
lst_insitu_dem_forresid = mcreg(x = validation$avg_temp, y = validation$surface_temp_mean, method.reg = 'Deming')
validation$opt_resid = MCResult.getResiduals(lst_insitu_dem_forresid)$optimized
ggplot(validation, aes(sample = opt_resid)) +
geom_qq() +
geom_qq_line()
ggplot(validation, aes (y = opt_resid, x = avg_temp)) +
geom_point() +
labs(x = 'in-situ mean water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_x_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = avg_temp, color = month)) +
geom_point(size = 2) +
labs(x = 'in-situ mean water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_x_colorbymonth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = cloud_cover)) +
geom_point() +
labs(x = 'cloud cover (percent)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_cloudcover_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = cloud_cover, color = month)) +
geom_point(size = 2) +
labs(x = 'cloud cover (percent)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_cloudcover_colorbymonth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = pixel_count)) +
geom_point() +
labs(x = 'pixel count',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_pixelcount_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = pixel_count, color = month)) +
geom_point(size = 2) +
labs(x = 'pixel count',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_pixelcount_colorbymonth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = avg_depth)) +
geom_point() +
labs(x = 'mean in-situ depth (m)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_insitudepth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = avg_depth, color = month)) +
geom_point(size = 2) +
labs(x = 'mean in-situ depth (m)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_insitudepth_colorbymonth_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = month)) +
geom_point() +
labs(x = 'month',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_month_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = month, color = pixel_count)) +
geom_point(size = 2) +
labs(x = 'month',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_month_bypixelcount_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = month, color = cloud_cover)) +
geom_point(size = 2) +
labs(x = 'month',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_month_bycloudcover_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = year)) +
geom_point() +
labs(x = 'year',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_year_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = year, color = pixel_count)) +
geom_point(size = 2) +
labs(x = 'year',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_year_bypixelcount_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = year, color = cloud_cover)) +
geom_point(size = 2) +
labs(x = 'year',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_year_bycloudcover_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = doy)) +
geom_point() +
labs(x = 'doy',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_doy_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = doy, color = pixel_count)) +
geom_point(size = 2) +
labs(x = 'doy',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_doy_bypixelcount_v17May2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation, aes (y = opt_resid, x = doy, color = cloud_cover)) +
geom_point(size = 2) +
labs(x = 'doy',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_doy_bycloudcover_v17May2021.jpg'), height = 5, width = 8, units = 'in')
cor_pixel_doy = round(cor(x = validation$pixel_count, y = validation$doy), digits = 2)
pixel_doy <- ggplot(validation, aes(x = pixel_count, y = doy)) +
geom_point() +
geom_text(label = paste0('r = ', cor_pixel_doy), aes(y = 125, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='day of year') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
cor_pixel_cloud = round(cor(x = validation$pixel_count, y = validation$cloud_cover), digits = 2)
cor_pixel_cloud = '-0.50' #save as character for digit resolution
pixel_cloud <- ggplot(validation, aes(x = pixel_count, y = cloud_cover)) +
geom_point() +
geom_text(label = paste0('r = ', cor_pixel_cloud), aes(y = 0, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
cor_doy_cloud = round(cor(x = validation$doy, y = validation$cloud_cover), digits = 2)
doy_cloud <- ggplot(validation, aes(x = doy, y = cloud_cover)) +
geom_point() +
geom_text(label = paste0('r = ', cor_doy_cloud), aes(y = 0, x = 275)) +
labs(x = 'day of year\n', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
plot_grid(pixel_doy, pixel_cloud, doy_cloud, labels = c('a', 'b', 'c'), nrow = 1)
ggsave(paste0(dir, 'figures/correlation_plot.png'), width = 12, height = 4)
cor_pixel_doy = round(cor(x = validation$pixel_count, y = validation$doy), digits = 2)
pixel_doy <- ggplot(validation, aes(x = pixel_count, y = doy)) +
geom_point() +
annotate(label = paste0('r = ', cor_pixel_doy), aes(y = 125, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='day of year') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
pixel_doy <- ggplot(validation, aes(x = pixel_count, y = doy)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_pixel_doy), aes(y = 125, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='day of year') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
cor_pixel_cloud = round(cor(x = validation$pixel_count, y = validation$cloud_cover), digits = 2)
pixel_cloud <- ggplot(validation, aes(x = pixel_count, y = cloud_cover)) +
geom_point() +
annotate(text, label = paste0('r = ', cor_pixel_cloud), aes(y = 0, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
pixel_cloud <- ggplot(validation, aes(x = pixel_count, y = cloud_cover)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_pixel_cloud), aes(y = 0, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
doy_cloud <- ggplot(validation, aes(x = doy, y = cloud_cover)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_doy_cloud), aes(y = 0, x = 275)) +
labs(x = 'day of year\n', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
plot_grid(pixel_doy, pixel_cloud, doy_cloud, labels = c('a', 'b', 'c'), nrow = 1)
plot_grid(pixel_doy, pixel_cloud, doy_cloud, labels = c('a', 'b', 'c'), nrow = 1)
ggplot(validation, aes(x = pixel_count, y = doy)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_pixel_doy), aes(y = 125, x = 8500)) +
labs(x = 'pixel count\ncontributing to mean LST', y='day of year') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
pixel_doy <- ggplot(validation, aes(x = pixel_count, y = doy)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_pixel_doy), y = 125, x = 8500) +
labs(x = 'pixel count\ncontributing to mean LST', y='day of year') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
ggplot(validation, aes(x = pixel_count, y = doy)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_pixel_doy), y = 125, x = 8500) +
labs(x = 'pixel count\ncontributing to mean LST', y='day of year') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
pixel_doy <- ggplot(validation, aes(x = pixel_count, y = doy)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_pixel_doy), y = 125, x = 8500) +
labs(x = 'pixel count\ncontributing to mean LST', y='day of year') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
pixel_cloud <- ggplot(validation, aes(x = pixel_count, y = cloud_cover)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_pixel_cloud), y = 0, x = 8500) +
labs(x = 'pixel count\ncontributing to mean LST', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
doy_cloud <- ggplot(validation, aes(x = doy, y = cloud_cover)) +
geom_point() +
annotate('text', label = paste0('r = ', cor_doy_cloud), y = 0, x = 275) +
labs(x = 'day of year\n', y='percent cloud cover\nin Landsat image') +
final_theme+
theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
ggsave(paste0(dir, 'figures/correlation_plot.png'), width = 12, height = 4)
plot_grid(pixel_doy, pixel_cloud, doy_cloud, labels = c('a', 'b', 'c'), nrow = 1)
ggsave(paste0(dir, 'figures/correlation_plot.png'), width = 12, height = 4)
plot_grid(pixel_doy, pixel_cloud, doy_cloud, labels = c('a', 'b', 'c'), nrow = 1)
ggsave(paste0(dir, 'figures/correlation_plot.png'), width = 12, height = 4)
View(validation_dem)
View(validation_ls)
View(validation)
