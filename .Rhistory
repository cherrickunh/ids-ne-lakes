ls_8_lm_wo <- lm(value~year, data = ls_aug_data_wo)
is_8_lm_wo <- lm(value~year, data = is_aug_data_wo)
lm_source_sep_iva <- lm(value ~ year+source+year*source, data = sep_data)
summary(lm_source_sep_iva)
# there is a significant difference in slope
lm_source_sep <- lm(value ~ year+source, data = sep_data)
summary(lm_source_sep)
all_9_lm
is_9_lm
ls_9_lm
#plot one line for landsat
ls_9_data <- sep_data %>%
filter(source == 'landsat')
car::durbinWatsonTest(lm(value~year, data = ls_9_data))
#confirms autocorrelation
# do analysis without outliers
sep_data_wo <- sep_data %>%
filter(value >15)
lm_source_sep_iva_wo <- lm(value ~ year+source+year*source, data = sep_data_wo)
summary(lm_source_sep_iva_wo)
# sig diff in slope
lm_source_sep_wo <- lm(value ~ year+source, data = sep_data_wo)
summary(lm_source_sep_wo)
lm_sep_wo <- lm(value ~ year, data = sep_data_wo)
summary(lm_sep_wo)
ls_sep_data_Wo <- sep_data_wo %>%
filter(source == 'landsat')
is_sep_data_Wo <- sep_data_wo %>%
filter(source == 'in-situ')
ls_9_lm_wo = lm(value ~ year, data = ls_sep_data_Wo)
summary(ls_9_lm_wo)
is_9_lm_wo = lm(value ~ year, data = is_sep_data_Wo)
is_9_lm
#plot one line for landsat
lm_source_oct_iva <- lm(value ~ year+source+year*source, data = oct_data)
summary(lm_source_oct_iva)
#no diff in slope
lm_source_oct <- lm(value ~ year+source, data = oct_data)
summary(lm_source_oct)
#no diff in intercept
all_10_lm
#plot one line
car::durbinWatsonTest(lm(value~year, data = oct_data))
#confirms autocorrelation
# IVA results to table ####
iva_table <- NULL
iva_table$month <- c('May', 'June', 'July', 'August', 'August, outliers removed', 'September', 'September, outliers removed', 'October')
iva_table$iva_pval <- c(summary(lm_source_may_iva)$coefficients[4,4],
summary(lm_source_jun_iva)$coefficients[4,4],
summary(lm_source_jul_iva)$coefficients[4,4],
summary(lm_source_aug_iva)$coefficients[4,4],
summary(lm_source_aug_iva_wo)$coefficients[4,4],
summary(lm_source_sep_iva)$coefficients[4,4],
summary(lm_source_sep_iva_wo)$coefficients[4,4],
summary(lm_source_oct_iva)$coefficients[4,4])
iva_table$multreg_pval <- c(summary(lm_source_may)$coefficients[3,4],
summary(lm_source_jun)$coefficients[3,4],
summary(lm_source_jul)$coefficients[3,4],
summary(lm_source_aug)$coefficients[3,4],
summary(lm_source_aug_wo)$coefficients[3,4],
summary(lm_source_sep)$coefficients[3,4],
summary(lm_source_sep_wo)$coefficients[3,4],
summary(lm_source_oct)$coefficients[3,4])
iva_table$alldata_slope_pval <- c(all_5_lm$coefficients[2,4],
all_6_lm$coefficients[2,4],
all_7_lm$coefficients[2,4],
all_8_lm$coefficients[2,4],
summary(lm_aug_wo)$coefficients[2,4],
all_9_lm$coefficients[2,4],
summary(lm_sep_wo)$coefficients[2,4],
all_10_lm$coefficients[2,4])
iva_table$ls_slope_pval <- c(ls_5_lm$coefficients[2,4],
ls_6_lm$coefficients[2,4],
ls_7_lm$coefficients[2,4],
ls_8_lm$coefficients[2,4],
summary(ls_8_lm_wo)$coefficients[2,4],
ls_9_lm$coefficients[2,4],
summary(ls_9_lm_wo)$coefficients[2,4],
ls_10_lm$coefficients[2,4])
iva_table$is_slope_pval <- c(is_5_lm$coefficients[2,4],
is_6_lm$coefficients[2,4],
is_7_lm$coefficients[2,4],
is_8_lm$coefficients[2,4],
summary(is_8_lm_wo)$coefficients[2,4],
is_9_lm$coefficients[2,4],
summary(is_9_lm_wo)$coefficients[2,4],
is_10_lm$coefficients[2,4])
iva_table <- as.data.frame(iva_table)
iva_table <- iva_table %>%
mutate_at(vars(iva_pval:is_slope_pval),
~ round(., digits = 3))
# recode table values where they are irrelevant
iva_table_recode <- iva_table %>%
mutate(multreg_pval = case_when(iva_pval <0.05 ~ NA_real_,
TRUE ~ multreg_pval),
alldata_slope_pval = case_when(multreg_pval <0.05 ~NA_real_,
iva_pval <0.05~NA_real_,
is.na(multreg_pval) ~ alldata_slope_pval,
TRUE ~ alldata_slope_pval),
is_slope_pval = case_when(iva_pval <0.05 ~ is_slope_pval,
multreg_pval < 0.05 ~ is_slope_pval,
TRUE ~ NA_real_),
ls_slope_pval = case_when(iva_pval <0.05 ~ ls_slope_pval,
multreg_pval < 0.05 ~ ls_slope_pval,
TRUE ~ NA_real_))
iva_table_recode
#### plot on same axes with separate lines ####
may <- temp_monthly_median %>%
filter(month == 5) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'May') +
theme(legend.position = 'none')
may
june <- temp_monthly_median %>%
filter(month == 6) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'June') +
theme(legend.position = 'none')
june
jul <- temp_monthly_median %>%
filter(month == 7) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
geom_abline(slope = all_7_lm$coefficients[2, 1],
intercept = all_7_lm$coefficients[1,1],
color = 'blue') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'July') +
theme(legend.position = 'none')
jul
aug <- temp_monthly_median %>%
filter(month == 8 & value < 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'black') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug
aug <- temp_monthly_median %>%
filter(month == 8 & value < 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'black') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug <- temp_monthly_median %>%
filter(month == 8 & value < 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aug_data, aes(x = year, y = value, color = 'grey')) +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'black') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug <- temp_monthly_median %>%
filter(month == 8 & value < 15) %>%
ggplot(., aes(x = year, y = value))+
# geom_point(aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'black') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug
aug <- temp_monthly_median %>%
filter(month == 8 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'black') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug <- temp_monthly_median %>%
filter(month == 8 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
# geom_point(aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'black') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug
aug <- temp_monthly_median %>%
filter(month == 8 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(data = aug_data, x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'blue') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug <- temp_monthly_median %>%
filter(month == 8 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(aug_data, x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'blue') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug <- temp_monthly_median %>%
filter(month == 8 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(data = aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'blue') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug
aug <- temp_monthly_median %>%
filter(month == 8 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(data = aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'grey') +
geom_abline(slope = summary(lm_aug_wo)$coefficients[2, 1],
intercept = summary(lm_aug_wo)$coefficients[1,1],
color = 'blue') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug
sep <- temp_monthly_median %>%
filter(month == 9 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(data = aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_9_lm$coefficients[2, 1],
intercept = all_9_lm$coefficients[1,1],
color = 'grey') +
geom_abline(slope = summary(lm_sep_wo)$coefficients[2, 1],
intercept = summary(lm_sep_wo)$coefficients[1,1],
color = 'blue') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'September') +
theme(legend.position = 'none')
sep
sep <- temp_monthly_median %>%
filter(month == 9 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(data = sep_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = ls_9_lm$coefficients[2, 1],
intercept = ls_9_lm$coefficients[1,1],
color = 'grey') +
geom_abline(slope = summary(ls_9_lm_wo)$coefficients[2, 1],
intercept = summary(ls_9_lm_wo)$coefficients[1,1],
color = '#E69F00') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'September') +
theme(legend.position = 'none')
sep
sep <- temp_monthly_median %>%
filter(month == 9 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(data = sep_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = ls_9_lm$coefficients[2, 1],
intercept = ls_9_lm$coefficients[1,1],
color = '#E69F00',
lty = 2) +
geom_abline(slope = summary(ls_9_lm_wo)$coefficients[2, 1],
intercept = summary(ls_9_lm_wo)$coefficients[1,1],
color = '#E69F00') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'September') +
theme(legend.position = 'none')
sep
oct <- temp_monthly_median %>%
filter(month == 10) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
geom_abline(slope = all_10_lm$coefficients[2, 1],
intercept = all_10_lm$coefficients[1,1],
color = "blue") +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'October') +
theme(legend.position = 'none')
oct
#set up png device
png(file.path(figdir, 'application_monthly_median_temp_cloud_together.png'),
width=9,height=6, units = 'in', res = 300)
gridExtra::grid.arrange(may, june, jul, aug, sept, oct,
nrow = 2,
left = 'lake surface temperature\ndegrees C',
bottom = 'black = in-situ   yellow = Landsat   blue = Landsat + in-situ trend')
gridExtra::grid.arrange(may, june, jul, aug, sep, oct,
nrow = 2,
left = 'lake surface temperature\ndegrees C',
bottom = 'black = in-situ   yellow = Landsat   blue = Landsat + in-situ trend')
#Close pdf graphics device
dev.off()
aug <- temp_monthly_median %>%
filter(month == 8 & value > 15) %>%
ggplot(., aes(x = year, y = value))+
geom_point(data = aug_data, aes(x = year, y = value), color = 'grey') +
geom_point(aes(color = source)) +
geom_abline(slope = all_8_lm$coefficients[2, 1],
intercept = all_8_lm$coefficients[1,1],
color = 'blue',
lty=2) +
geom_abline(slope = summary(lm_aug_wo)$coefficients[2, 1],
intercept = summary(lm_aug_wo)$coefficients[1,1],
color = 'blue') +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug
#set up png device
png(file.path(figdir, 'application_monthly_median_temp_cloud_together.png'),
width=9,height=6, units = 'in', res = 300)
gridExtra::grid.arrange(may, june, jul, aug, sep, oct,
nrow = 2,
left = 'lake surface temperature\ndegrees C',
bottom = 'black = in-situ   yellow = Landsat   blue = Landsat + in-situ trend')
#Close pdf graphics device
dev.off()
#set up png device
png(file.path(figdir, 'application_monthly_median_temp_cloud_together.png'),
width=9,height=6, units = 'in', res = 300)
gridExtra::grid.arrange(may, june, jul, aug, sep, oct,
nrow = 2,
left = 'lake surface temperature\ndegrees C',
bottom = 'black = in-situ   yellow = Landsat   grey = outlier   blue = Landsat + in-situ trend')
#Close pdf graphics device
dev.off()
#### plot with connected lines ####
may_inter <- temp_monthly_median %>%
filter(month == 5) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
geom_line(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'May') +
theme(legend.position = 'none')
may_inter
june_inter <- temp_monthly_median %>%
filter(month == 6) %>%
ggplot(., aes(x = year, y = value))+
geom_line(aes(color = source)) +
geom_point(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'June') +
theme(legend.position = 'none')
june_inter
jul_inter <- temp_monthly_median %>%
filter(month == 7) %>%
ggplot(., aes(x = year, y = value))+
geom_line(aes(color = source)) +
geom_point(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'July') +
theme(legend.position = 'none')
jul_inter
aug_inter <- temp_monthly_median %>%
ggplot(., aes(x = year, y = value))+
geom_line(aes(color = source)) +
geom_point(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug_inter
aug_inter <- temp_monthly_median %>%
filter(month == 8) %>%
ggplot(., aes(x = year, y = value))+
geom_line(aes(color = source)) +
geom_point(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'August') +
theme(legend.position = 'none')
aug_inter
sep_inter <- temp_monthly_median %>%
filter(month == 9) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
geom_line(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'September') +
theme(legend.position = 'none')
sep_inter
oct_inter <- temp_monthly_median %>%
filter(month == 10) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
geom_line(aes(color = source)) +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1980, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'October') +
theme(legend.position = 'none')
oct_inter
#set up png device
png(file.path(figdir, 'application_monthly_median_temp_cloud_together_interconnected.png'),
width=9,height=6, units = 'in', res = 300)
gridExtra::grid.arrange(may, june, jul, aug, sep, oct,
nrow = 2,
left = 'lake surface temperature\ndegrees C',
bottom = 'black = in-situ   yellow = Landsat')
#Close pdf graphics device
dev.off()
#set up png device
png(file.path(figdir, 'application_monthly_median_temp_cloud_together_interconnected.png'),
width=9,height=6, units = 'in', res = 300)
gridExtra::grid.arrange(may_inter, june_inter, jul_inter, aug_inter, sep_inter, oct_inter,
nrow = 2,
left = 'lake surface temperature\ndegrees C',
bottom = 'black = in-situ   yellow = Landsat')
#Close pdf graphics device
dev.off()
