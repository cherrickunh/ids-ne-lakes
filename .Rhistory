# by earth sun distance
esd <- ggplot(C2ST_cloud, aes(x = earthsun_d, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'earth sun distance (UNITS)\n',
y = '\n') +
final_theme
# by azimuth
azi <- ggplot(C2ST_cloud, aes(x = sunazi, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'sun azimuth (degrees)\n',
y = '\n') +
final_theme
# depth of sensor
depth <- ggplot(C2ST_cloud, aes(x = depth_avg, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'average depth of sensor (m)\n',
y = '\n') +
final_theme
# std dev in-situ temp
sd <- ggplot(C2ST_cloud, aes(x = t_stdev, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'standard deviation of temps\ncontributing to median (deg C)',
y = '\n') +
final_theme
#in-situ count
count <- ggplot(C2ST_cloud, aes(x = insitu_count, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'number of insitu measurements\ncontributing to median',
y = '\n') +
final_theme
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
ncol = 2,
label_x = 0.1,
label_y = 1.1)
ggsave(file.path(fig_dir, 'SFA_resid_summary_C2cloud_v14Oct2021.jpg'),
height = 12, width = 8, units = 'in', dpi = 300)
# Calculate error for various models ####
alldata_error <- all_surface_temp %>%
group_by(collection, filter) %>%
summarise(mse = round(sum((opt_resid^2))/n(), digits = 2),
rmse = round(sqrt(mse), digits = 2),
bias = round(sum(opt_resid)/n(), digits = 2),
mae = round(sum(abs(opt_resid))/n(), digits = 2),
n_obs = n())  %>%
mutate(month = 'All data',
LSmission = 'All missions') %>%
pivot_longer(cols = c(mse:n_obs), names_to = 'variable', values_to = 'values') %>%
mutate(variable = factor(variable, levels = c('n_obs', 'mae', 'rmse', 'mse', 'bias'))) %>%
arrange(month, variable) %>%
pivot_wider(names_from = c(LSmission),
values_from = values)
mission_error <- all_surface_temp %>%
group_by(collection, LSmission, filter) %>%
summarise(mse = round(sum((opt_resid^2))/n(), digits = 2),
rmse = round(sqrt(mse), digits = 2),
bias = round(sum(opt_resid)/n(), digits = 2),
mae = round(sum(abs(opt_resid))/n(), digits = 2),
n_obs = n())  %>%
mutate(month = 'All data') %>%
pivot_longer(cols = c(mse:n_obs), names_to = 'variable', values_to = 'values') %>%
mutate(variable = factor(variable, levels = c('n_obs', 'mae', 'rmse', 'mse', 'bias'))) %>%
arrange(month, variable) %>%
pivot_wider(names_from = c(LSmission),
values_from = values)
alldata_error <- full_join(alldata_error, mission_error)
alldata_error
month_mission_error <- all_surface_temp %>%
group_by(collection, month, LSmission, filter) %>%
summarise(mse = round(sum((opt_resid^2))/n(), digits = 2),
rmse = round(sqrt(mse), digits = 2),
bias = round(sum(opt_resid)/n(), digits = 2),
mae = round(sum(abs(opt_resid))/n(), digits = 2),
n_obs = n())  %>%
select(month, collection, LSmission, filter,n_obs, mae, rmse, bias) %>%
pivot_longer(!c(month, LSmission, collection, filter), names_to = 'variable', values_to = 'values') %>%
mutate(variable = factor(variable, levels = c('n_obs', 'mae', 'rmse', 'mse', 'bias'))) %>%
arrange(month, variable) %>%
pivot_wider(names_from = c(LSmission),
values_from = values)
month_error <- all_surface_temp %>%
group_by(collection, month, filter) %>%
summarise(mse = round(sum((opt_resid^2))/n(), digits = 2),
rmse = round(sqrt(mse), digits = 2),
bias = round(sum(opt_resid)/n(), digits = 2),
mae = round(sum(abs(opt_resid))/n(), digits = 2),
n_obs = n())  %>%
mutate(LSmission = 'All missions') %>%
select(month, collection, LSmission, filter, n_obs, mae, rmse, bias) %>%
pivot_longer(!c(month, LSmission, filter, collection), names_to = 'variable', values_to = 'values') %>%
mutate(variable = factor(variable, levels = c('n_obs', 'mae', 'rmse', 'mse', 'bias'))) %>%
arrange(month, variable) %>%
pivot_wider(names_from = c(LSmission),
values_from = values)
month_error <- full_join(month_mission_error, month_error)
alldata_error <- full_join(alldata_error, month_error)
write.csv(alldata_error, file.path(C2_datadir, 'LS_deming_predictionerror_C1C2_stats_v15Oct2021.csv'))
# Create bar charts of bias and MAE for missions and months ####
head(alldata_error)
unique(alldata_error$variable)
alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias'))
alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`)
alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`)
alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value')
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value')
alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(c_filter = paste0('C', collection, ' ', filter))
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(c_filter = paste0('C', collection, ' ', filter))
ggplot(mission, aes(x = c_filter, y = value)) +
goem_bar() +
facet_grid(variable)
ggplot(mission, aes(x = c_filter, y = value)) +
geom_bar() +
facet_grid(variable)
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(c_filter = paste0('C', collection, ' ', filter))
ggplot(mission, aes(x = c_filter, y = value)) +
geom_bar() +
facet_grid(variable ~.)
ggplot(mission, aes(x = c_filter, y = value)) +
geom_col() +
facet_grid(variable ~.)
ggplot(mission, aes(x = c_filter, y = value)) +
geom_col() +
facet_grid(variable ~., scales = 'free_y')
ggplot(mission, aes(x = c_filter, y = value)) +
geom_col(group_by(mission)) +
facet_grid(variable ~., scales = 'free_y')
ggplot(mission, aes(x = c_filter, y = value, color = mission)) +
geom_col() +
facet_grid(variable ~., scales = 'free_y')
ggplot(mission, aes(x = c_filter, y = value, color = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y')
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range')))
ggplot(mission, aes(x = c_filter, y = value, color = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y')
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y')
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
scale_color_colorblind()
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
scale_fill_colorblind()
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
scale_fill_colorblind()
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL)+
scale_fill_colorblind()
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
theme(legend.title = 'Landsat\nmission')+
labs(x = NULL,
y = NULL)+
scale_fill_colorblind()
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
theme(legend.title = element_text('Landsat\nmission'))+
labs(x = NULL,
y = NULL)+
scale_fill_colorblind()
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
theme(legend.title = element_text('blank'))+
labs(x = NULL,
y = NULL)+
scale_fill_colorblind()
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'Landsat\nmission')+
scale_fill_colorblind()
alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-(`LS 5`:`LS 8`)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
ggplot(month, aes(x = c_filter, y = value, fill = month)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'Landsat\nmission')+
scale_fill_colorblind()
alldata_error %>%
filter(month != 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-(`LS 5`:`LS 8`)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
month <- alldata_error %>%
filter(month != 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-(`LS 5`:`LS 8`)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
ggplot(month, aes(x = c_filter, y = value, fill = month)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'Landsat\nmission')+
scale_fill_colorblind()
ggplot(month, aes(x = c_filter, y = `All missions`, fill = month)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'Landsat\nmission')+
scale_fill_colorblind()
month <- alldata_error %>%
filter(month != 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-(`LS 5`:`LS 8`)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)')) %>%
mutate(month_text = case_when(month == '05' ~ 'May',
month == '06' ~ 'June'
month == '07' ~ 'July',
month == '08' ~ 'August',
month == '09' ~ 'September',
month == '10' ~ 'October'))
ggplot(month, aes(x = c_filter, y = `All missions`, fill = month_text)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'month')+
scale_fill_colorblind()
month <- alldata_error %>%
filter(month != 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-(`LS 5`:`LS 8`)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)')) %>%
mutate(month_text = case_when(month == '05' ~ 'May',
month == '06' ~ 'June',
month == '07' ~ 'July',
month == '08' ~ 'August',
month == '09' ~ 'September',
month == '10' ~ 'October'))
ggplot(month, aes(x = c_filter, y = `All missions`, fill = month_text)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'month')+
scale_fill_colorblind()
View(month)
month <- alldata_error %>%
filter(month != 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-(`LS 5`:`LS 8`)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)')) %>%
mutate(month_text = case_when(month == '05' ~ 'May',
month == '06' ~ 'June',
month == '07' ~ 'July',
month == '08' ~ 'August',
month == '09' ~ 'September',
month == '10' ~ 'October',
month == '11' ~ 'November'))
ggplot(month, aes(x = c_filter, y = `All missions`, fill = month_text)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'month')+
scale_fill_colorblind()
month <- alldata_error %>%
filter(month != 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-(`LS 5`:`LS 8`)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)')) %>%
mutate(month_text = case_when(month == '05' ~ 'May',
month == '06' ~ 'June',
month == '07' ~ 'July',
month == '08' ~ 'August',
month == '09' ~ 'September',
month == '10' ~ 'October',
month == '11' ~ 'November')) %>%
mutate(month_text = factor(month_text, levels = c('May', 'June', 'July', 'August', 'September', 'October', 'November')))
ggplot(month, aes(x = c_filter, y = `All missions`, fill = month_text)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'month')+
scale_fill_colorblind()
View(month)
View(alldata_error)
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'Landsat\nmission')+
scale_fill_colorblind()
ggsave(file.path(fig_dir, 'FigG_errorbymission.jpg'), height = 5, width = 8, units = 'in', dpi = 300)
ggplot(month, aes(x = c_filter, y = `All missions`, fill = month_text)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'month')+
scale_fill_colorblind()
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'Landsat\nmission')+
scale_fill_colorblind() +
final_theme
ggsave(file.path(fig_dir, 'FigG_errorbymission.jpg'), height = 5, width = 8, units = 'in', dpi = 300)
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(filter = case_when(filter == 'none' ~ '',
TRUE ~ filter)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1', 'C2', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'Landsat\nmission')+
scale_fill_colorblind() +
final_theme
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(filter = case_when(filter == 'none' ~ '',
TRUE ~ filter)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1  ', 'C2  ', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(filter = case_when(filter == 'none' ~ '',
TRUE ~ filter)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 ', 'C2 ', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
unique(alldata_error$filter)
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(filter = case_when(filter == as.factor('none') ~ '',
TRUE ~ filter)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 ', 'C2 ', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
mission <- alldata_error %>%
filter(month == 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-`All missions`) %>%
pivot_longer(cols = c(`LS 5`:`LS 8`),
names_to = 'mission',
values_to = 'value') %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter,
levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'),
labels = c('C1', 'C2', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)'))
ggplot(mission, aes(x = c_filter, y = value, fill = mission)) +
geom_col(position = 'dodge') +
facet_grid(variable ~., scales = 'free_y') +
labs(x = NULL,
y = NULL,
fill = 'Landsat\nmission')+
scale_fill_colorblind() +
final_theme
ggsave(file.path(fig_dir, 'FigG_errorbymission.jpg'), height = 5, width = 8, units = 'in', dpi = 300)
month <- alldata_error %>%
filter(month != 'All data' & (variable == 'mae' | variable == 'bias')) %>%
select(-(`LS 5`:`LS 8`)) %>%
mutate(c_filter = paste0('C', collection, ' ', filter)) %>%
mutate(c_filter = factor(c_filter, levels = c('C1 none', 'C2 none', 'C2 freeze',
'C2 IQR', 'C2 cloud', 'C2 range'))) %>%
mutate(variable = case_when(variable == 'mae' ~ 'mean absolute error (deg C)',
variable == 'bias' ~ 'bias (deg C)')) %>%
mutate(month_text = case_when(month == '05' ~ 'May',
month == '06' ~ 'June',
month == '07' ~ 'July',
month == '08' ~ 'August',
month == '09' ~ 'September',
month == '10' ~ 'October',
month == '11' ~ 'November')) %>%
mutate(month_text = factor(month_text, levels = c('May', 'June', 'July', 'August', 'September', 'October', 'November')))
ggsave(file.path(fig_dir, 'FigI_errorbymonth.jpg'),height = 5, width = 8, units = 'in', dpi = 300)
