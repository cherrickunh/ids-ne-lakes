ggsave(file.path(fig_dir, 'FigureC_deming_filters.jpg'),
dpi = 300,
height = 8,
width = 12,
units = 'in')
# Plot Deming regression for all filters ####
FigC_a <- ggplot(C1SC, aes(x = temp_med, y = surface_temp_median)) +
geom_abline(slope = 1, intercept = 0, color = 'grey', size = 0.75) +
geom_point() +
#add deming regression and prediction intervals for C1
geom_abline(intercept = C1_deming$coefficients[1], slope = C1_deming$coefficients[2], size = 0.75) +
geom_abline(intercept = C1_deming$ci[1,1], slope = C1_deming$ci[2,1], linetype = 3, size = 0.75) +
geom_abline(intercept = C1_deming$ci[1,2], slope = C1_deming$ci[2,2], linetype = 3, size = 0.75) +
geom_text(label = paste0('r = ', round(cor(C1SC$surface_temp_median, C1SC$temp_med), digits = 3)),
x = 2,
y = 25,
size = 4,
hjust = 0)+
geom_text(label = paste0('n = ', length(C1SC$date)),
x = 2,
y = 23,
size = 4,
hjust = 0)+
labs(x = '',
y = 'median Landsat-derived\nsurface temperature (deg C)',
title = 'Collection 1',
subtitle = '') +
final_theme +
coord_cartesian(xlim = c(0, 27),
ylim = c(0, 27))
FigC_a
FigC_b <- ggplot(C2ST, aes(x = temp_med, y = surface_temp_median)) +
geom_abline(slope = 1, intercept = 0, color = 'grey', size = 0.75) +
geom_point() +
#add deming regression and prediction intervals for C2
geom_abline(intercept = C2_deming$coefficients[1], slope = C2_deming$coefficients[2], size = 0.75) +
geom_abline(intercept = C2_deming$ci[1,1], slope = C2_deming$ci[2,1], linetype = 3, size = 0.75) +
geom_abline(intercept = C2_deming$ci[1,2], slope = C2_deming$ci[2,2], linetype = 3, size = 0.75) +
geom_text(label = paste0('r = ', round(cor(C2ST$surface_temp_median, C2ST$temp_med), digits = 3)),
x = 2,
y = 25,
size = 4,
hjust = 0)+
geom_text(label = paste0('n = ', length(C2ST$date)),
x = 2,
y = 23,
size = 4,
hjust = 0)+
labs(x = '',
y = '\n',
title = 'Collection 2',
subtitle = '') +
final_theme +
coord_cartesian(xlim = c(0, 27),
ylim = c(0, 27))
FigC_b
FigC_c <- ggplot(C2ST_freeze, aes(x = temp_med, y = surface_temp_median)) +
geom_abline(slope = 1, intercept = 0, color = 'grey', size = 0.75) +
geom_point() +
#add deming regression and prediction intervals for C2 filtered for freezing mins
geom_abline(intercept = C2_freeze_deming$coefficients[1], slope = C2_freeze_deming$coefficients[2], size = 0.75) +
geom_abline(intercept = C2_freeze_deming$ci[1,1], slope = C2_freeze_deming$ci[2,1], linetype = 3, size = 0.75) +
geom_abline(intercept = C2_freeze_deming$ci[1,2], slope = C2_freeze_deming$ci[2,2], linetype = 3, size = 0.75) +
geom_text(label = paste0('r = ', round(cor(C2ST_freeze$surface_temp_median, C2ST_freeze$temp_med), digits = 3)),
x = 2,
y = 25,
size = 4,
hjust = 0)+
geom_text(label = paste0('n = ', length(C2ST_freeze$date)),
x = 2,
y = 23,
size = 4,
hjust = 0)+
labs(x = '',
y = '\n',
title = 'Collection 2',
subtitle = 'filtered for sub-zero temperatures') +
final_theme +
coord_cartesian(xlim = c(0, 27),
ylim = c(0, 27))
FigC_c
FigC_plot <- plot_grid(FigC_a, FigC_b, FigC_c, FigC_d, FigC_e,
FigC_f,
ncol = 3,
labels = c('a', 'b', 'c', 'd', 'e', 'f'),
label_x = 0.15)
FigC_plot
ggsave(file.path(fig_dir, 'FigureC_deming_filters.jpg'),
dpi = 300,
height = 8,
width = 11,
units = 'in')
ggsave(file.path(fig_dir, 'FigureC_deming_filters.jpg'),
dpi = 300,
height = 9,
width = 12,
units = 'in')
# by insitu temp
doy <- ggplot(C2ST_maxIQR, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = expression(bold(paste(italic('in-situ'), ' median water temp (deg C)'))),
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by doy
doy <- ggplot(C2ST_maxIQR, aes(x = as.numeric(doy), y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'day of year\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by pixel count
perclake <- ggplot(C2ST_maxIQR, aes(x = (pixel_count/17134)*100, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'percent of lake\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by cloud cover
cloud <- ggplot(C2ST_maxIQR, aes(x = cloud_cover, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'cloud cover (percent)\n',
y = '\n') +
final_theme
# by sun elevation
sunelev <- ggplot(C2ST_maxIQR, aes(x = sunelev, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'sun elevation (UNITS)\n',
y = 'Deming-optimized residual\n(deg C)') +
final_theme
# by earth sun distance
esd <- ggplot(C2ST_maxIQR, aes(x = earthsun_d, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'earth sun distance (UNITS)\n',
y = '\n') +
final_theme
# by azimuth
azi <- ggplot(C2ST_maxIQR, aes(x = sunazi, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'sun azimuth (degrees)\n',
y = '\n') +
final_theme
# depth of sensor
depth <- ggplot(C2ST_maxIQR, aes(x = depth_avg, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'average depth of sensor (m)\n',
y = '\n') +
final_theme
# std dev in-situ temp
sd <- ggplot(C2ST_maxIQR, aes(x = t_stdev, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'standard deviation of temps\ncontributing to median (deg C)',
y = '\n') +
final_theme
#in-situ count
count <- ggplot(C2ST_maxIQR, aes(x = insitu_count, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'number of insitu measurements\ncontributing to median',
y = '\n') +
final_theme
# by insitu temp
doy <- ggplot(C2ST_maxcloud, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = expression(bold(paste(italic('in-situ'), ' median water temp (deg C)'))),
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by doy
doy <- ggplot(C2ST_maxcloud, aes(x = as.numeric(doy), y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'day of year\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by pixel count
perclake <- ggplot(C2ST_maxcloud, aes(x = (pixel_count/17134)*100, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'percent of lake\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by cloud cover
cloud <- ggplot(C2ST_maxcloud, aes(x = cloud_cover, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'cloud cover (percent)\n',
y = '\n') +
final_theme
# by sun elevation
sunelev <- ggplot(C2ST_maxcloud, aes(x = sunelev, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'sun elevation (UNITS)\n',
y = 'Deming-optimized residual\n(deg C)') +
final_theme
# by insitu temp
doy <- ggplot(C2ST_cloud, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = expression(bold(paste(italic('in-situ'), ' median water temp (deg C)'))),
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by doy
doy <- ggplot(C2ST_cloud, aes(x = as.numeric(doy), y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'day of year\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by pixel count
perclake <- ggplot(C2ST_cloud, aes(x = (pixel_count/17134)*100, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'percent of lake\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
final_theme
# by cloud cover
cloud <- ggplot(C2ST_cloud, aes(x = cloud_cover, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'cloud cover (percent)\n',
y = '\n') +
final_theme
# by sun elevation
sunelev <- ggplot(C2ST_cloud, aes(x = sunelev, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'sun elevation (UNITS)\n',
y = 'Deming-optimized residual\n(deg C)') +
final_theme
# by earth sun distance
esd <- ggplot(C2ST_cloud, aes(x = earthsun_d, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'earth sun distance (UNITS)\n',
y = '\n') +
final_theme
# by azimuth
azi <- ggplot(C2ST_cloud, aes(x = sunazi, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'sun azimuth (degrees)\n',
y = '\n') +
final_theme
# depth of sensor
depth <- ggplot(C2ST_cloud, aes(x = depth_avg, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'average depth of sensor (m)\n',
y = '\n') +
final_theme
# std dev in-situ temp
sd <- ggplot(C2ST_cloud, aes(x = t_stdev, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'standard deviation of temps\ncontributing to median (deg C)',
y = '\n') +
final_theme
#in-situ count
count <- ggplot(C2ST_cloud, aes(x = insitu_count, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-6, 6)) +
labs(x = 'number of insitu measurements\ncontributing to median',
y = '\n') +
final_theme
plot_grid(doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i'))
ggsave(file.path(fig_dir, 'resid_summary_C2cloud_v14Oct2021.jpg'), height = 8, width = 12, units = 'in', dpi = 300)
# by insitu temp
istemp <- ggplot(C2ST_cloud, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = expression(bold(paste(italic('in-situ'), ' median water temp (deg C)'))),
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
# by doy
doy <- ggplot(C2ST_cloud, aes(x = as.numeric(doy), y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'day of year\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'))
# by insitu temp
istemp <- ggplot(C2ST_cloud, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = expression(bold(paste(italic('in-situ'), ' median water temp\n(deg C)'))),
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
#in-situ count
count <- ggplot(C2ST_cloud, aes(x = insitu_count, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'number of insitu measurements\ncontributing to median',
y = '\n') +
final_theme
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'))
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
nrow = 3)
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
ncol = 3)
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
ncol = 5)
# by insitu temp
istemp <- ggplot(C2ST_cloud, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = expression(bold(paste(italic('in-situ'), ' median water temp\n(deg C)'))),
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
# by doy
doy <- ggplot(C2ST_cloud, aes(x = as.numeric(doy), y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'day of year\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
# by pixel count
perclake <- ggplot(C2ST_cloud, aes(x = (pixel_count/17134)*100, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'percent of lake\n',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
# by cloud cover
cloud <- ggplot(C2ST_cloud, aes(x = cloud_cover, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'cloud cover (percent)\n',
y = '\n') +
final_theme
# by sun elevation
sunelev <- ggplot(C2ST_cloud, aes(x = sunelev, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'sun elevation (UNITS)\n',
y = 'Deming-optimized residual\n(deg C)') +
final_theme
# by earth sun distance
esd <- ggplot(C2ST_cloud, aes(x = earthsun_d, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'earth sun distance (UNITS)\n',
y = '\n') +
final_theme
# by azimuth
azi <- ggplot(C2ST_cloud, aes(x = sunazi, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'sun azimuth (degrees)\n',
y = '\n') +
final_theme
# depth of sensor
depth <- ggplot(C2ST_cloud, aes(x = depth_avg, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'average depth of sensor (m)\n',
y = '\n') +
final_theme
# std dev in-situ temp
sd <- ggplot(C2ST_cloud, aes(x = t_stdev, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'standard deviation of temps\ncontributing to median (deg C)',
y = '\n') +
final_theme
#in-situ count
count <- ggplot(C2ST_cloud, aes(x = insitu_count, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
labs(x = 'number of insitu measurements\ncontributing to median',
y = '\n') +
final_theme
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'))
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
label_x = 0.15)
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
label_x = 0.1)
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
ncol = 3,
label_x = 0.1)
# by insitu temp
istemp <- ggplot(C2ST_cloud, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = expression(bold(paste(italic('in-situ'), ' median water temp (deg C)'))),
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
# by insitu temp
istemp <- ggplot(C2ST_cloud, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'in-situ median water temp\n(deg C)'))),
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
# by insitu temp
istemp <- ggplot(C2ST_cloud, aes(x = temp_med, y = opt_resid)) +
geom_point() +
# geom_line(aes(group = date)) +
labs(x = 'in-situ median water temp\n(deg C)',
y = '\n') +
geom_abline(intercept =  0, slope = 0) +
coord_cartesian(ylim = c(-5, 5)) +
final_theme
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
ncol = 3,
label_x = 0.1)
plot_grid(istemp, doy, perclake, cloud, sunelev, esd, azi, depth, sd, count,
labels = c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'),
ncol = 3,
label_x = 0.1,
label_y = 1.1)
