iva_table$alldata_slope_lower <- c(confint(lm(value~year, data = may_data),'year',level=0.95)[1],
confint(lm(value~year, data = jun_data),'year',level=0.95)[1],
confint(lm(value~year, data = jul_data),'year',level=0.95)[1],
confint(lm(value~year, data = aug_data),'year',level=0.95)[1],
confint(lm(value~year, data = sep_data),'year',level=0.95)[1],
confint(lm(value~year, data = oct_data),'year',level=0.95)[1])
iva_table$alldata_slope_upper <- c(confint(lm(value~year, data = may_data),'year',level=0.95)[2],
confint(lm(value~year, data = jun_data),'year',level=0.95)[2],
confint(lm(value~year, data = jul_data),'year',level=0.95)[2],
confint(lm(value~year, data = aug_data),'year',level=0.95)[2],
confint(lm(value~year, data = sep_data),'year',level=0.95)[2],
confint(lm(value~year, data = oct_data),'year',level=0.95)[2])
iva_table$alldata_slope_pval <- c(all_5_lm$coefficients[2,4],
all_6_lm$coefficients[2,4],
all_7_lm$coefficients[2,4],
all_8_lm$coefficients[2,4],
all_9_lm$coefficients[2,4],
all_10_lm$coefficients[2,4])
iva_table$alldata_DW_stat <- c(car::durbinWatsonTest(lm(value~year, data = may_data))$dw,
car::durbinWatsonTest(lm(value~year, data = jun_data))$dw,
car::durbinWatsonTest(lm(value~year, data = jul_data))$dw,
car::durbinWatsonTest(lm(value~year, data = aug_data))$dw,
car::durbinWatsonTest(lm(value~year, data = sep_data))$dw,
car::durbinWatsonTest(lm(value~year, data = oct_data))$dw)
iva_table$alldata_DW_pval <- c(car::durbinWatsonTest(lm(value~year, data = may_data))$p,
car::durbinWatsonTest(lm(value~year, data = jun_data))$p,
car::durbinWatsonTest(lm(value~year, data = jul_data))$p,
car::durbinWatsonTest(lm(value~year, data = aug_data))$p,
car::durbinWatsonTest(lm(value~year, data = sep_data))$p,
car::durbinWatsonTest(lm(value~year, data = oct_data))$p)
iva_table$ls_slope <- c(ls_5_lm$coefficients[2,1],
ls_6_lm$coefficients[2,1],
ls_7_lm$coefficients[2,1],
ls_8_lm$coefficients[2,1],
ls_9_lm$coefficients[2,1],
ls_10_lm$coefficients[2,1])
iva_table$ls_slope_lower <- c(confint(lm(value~year, data = may_data[may_data$source == 'landsat',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = jun_data[jun_data$source == 'landsat',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = jul_data[jul_data$source == 'landsat',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = aug_data[aug_data$source == 'landsat',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = sep_data[sep_data$source == 'landsat',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = oct_data[oct_data$source == 'landsat',]), 'year', level = 0.95)[1])
iva_table$ls_slope_upper <- c(confint(lm(value~year, data = may_data[may_data$source == 'landsat',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = jun_data[jun_data$source == 'landsat',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = jul_data[jul_data$source == 'landsat',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = aug_data[aug_data$source == 'landsat',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = sep_data[sep_data$source == 'landsat',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = oct_data[oct_data$source == 'landsat',]), 'year', level = 0.95)[2])
iva_table$ls_slope_pval <- c(ls_5_lm$coefficients[2,4],
ls_6_lm$coefficients[2,4],
ls_7_lm$coefficients[2,4],
ls_8_lm$coefficients[2,4],
ls_9_lm$coefficients[2,4],
ls_10_lm$coefficients[2,4])
iva_table$ls_DW_stat <- c(car::durbinWatsonTest(lm(value~year, data = may_data[may_data$source == 'landsat',]))$dw,
car::durbinWatsonTest(lm(value~year, data = jun_data[jun_data$source == 'landsat',]))$dw,
car::durbinWatsonTest(lm(value~year, data = jul_data[jul_data$source == 'landsat',]))$dw,
car::durbinWatsonTest(lm(value~year, data = aug_data[aug_data$source == 'landsat',]))$dw,
car::durbinWatsonTest(lm(value~year, data = sep_data[sep_data$source == 'landsat',]))$dw,
car::durbinWatsonTest(lm(value~year, data = oct_data[oct_data$source == 'landsat',]))$dw)
iva_table$ls_DW_pval <- c(car::durbinWatsonTest(lm(value~year, data = may_data[may_data$source == 'landsat',]))$p,
car::durbinWatsonTest(lm(value~year, data = jun_data[jun_data$source == 'landsat',]))$p,
car::durbinWatsonTest(lm(value~year, data = jul_data[jul_data$source == 'landsat',]))$p,
car::durbinWatsonTest(lm(value~year, data = aug_data[aug_data$source == 'landsat',]))$p,
car::durbinWatsonTest(lm(value~year, data = sep_data[sep_data$source == 'landsat',]))$p,
car::durbinWatsonTest(lm(value~year, data = oct_data[oct_data$source == 'landsat',]))$p)
iva_table$is_slope <- c(is_5_lm$coefficients[2,1],
is_6_lm$coefficients[2,1],
is_7_lm$coefficients[2,1],
is_8_lm$coefficients[2,1],
is_9_lm$coefficients[2,1],
is_10_lm$coefficients[2,1])
iva_table$is_slope_lower <- c(confint(lm(value~year, data = may_data[may_data$source == 'in-situ',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = jun_data[jun_data$source == 'in-situ',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = jul_data[jul_data$source == 'in-situ',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = aug_data[aug_data$source == 'in-situ',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = sep_data[sep_data$source == 'in-situ',]), 'year', level = 0.95)[1],
confint(lm(value~year, data = oct_data[oct_data$source == 'in-situ',]), 'year', level = 0.95)[1])
iva_table$is_slope_upper <- c(confint(lm(value~year, data = may_data[may_data$source == 'in-situ',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = jun_data[jun_data$source == 'in-situ',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = jul_data[jul_data$source == 'in-situ',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = aug_data[aug_data$source == 'in-situ',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = sep_data[sep_data$source == 'in-situ',]), 'year', level = 0.95)[2],
confint(lm(value~year, data = oct_data[oct_data$source == 'in-situ',]), 'year', level = 0.95)[2])
iva_table$is_slope_pval <- c(is_5_lm$coefficients[2,4],
is_6_lm$coefficients[2,4],
is_7_lm$coefficients[2,4],
is_8_lm$coefficients[2,4],
is_9_lm$coefficients[2,4],
is_10_lm$coefficients[2,4])
iva_table$is_DW_stat <- c(car::durbinWatsonTest(lm(value~year, data = may_data[may_data$source == 'in-situ',]))$dw,
car::durbinWatsonTest(lm(value~year, data = jun_data[jun_data$source == 'in-situ',]))$dw,
car::durbinWatsonTest(lm(value~year, data = jul_data[jul_data$source == 'in-situ',]))$dw,
car::durbinWatsonTest(lm(value~year, data = aug_data[aug_data$source == 'in-situ',]))$dw,
car::durbinWatsonTest(lm(value~year, data = sep_data[sep_data$source == 'in-situ',]))$dw,
car::durbinWatsonTest(lm(value~year, data = oct_data[oct_data$source == 'in-situ',]))$dw)
iva_table$is_DW_pval <- c(car::durbinWatsonTest(lm(value~year, data = may_data[may_data$source == 'in-situ',]))$p,
car::durbinWatsonTest(lm(value~year, data = jun_data[jun_data$source == 'in-situ',]))$p,
car::durbinWatsonTest(lm(value~year, data = jul_data[jul_data$source == 'in-situ',]))$p,
car::durbinWatsonTest(lm(value~year, data = aug_data[aug_data$source == 'in-situ',]))$p,
car::durbinWatsonTest(lm(value~year, data = sep_data[sep_data$source == 'in-situ',]))$p,
car::durbinWatsonTest(lm(value~year, data = oct_data[oct_data$source == 'in-situ',]))$p)
iva_table <- as.data.frame(iva_table)
iva_table <- iva_table %>%
mutate_at(vars(iva_pval:is_DW_pval),
~ round(., digits = 3))
# recode table values where they are irrelevant
iva_table_recode <- iva_table %>%
mutate_at(vars(multreg_pval),
~ case_when(iva_pval <0.05 ~ NA_real_,
TRUE ~ .)) %>%
mutate_at(vars(alldata_slope_pval, alldata_slope, alldata_slope_lower, alldata_slope_upper, alldata_DW_stat, alldata_DW_pval),
~ case_when(multreg_pval <0.05 ~NA_real_,
iva_pval <0.05~NA_real_,
is.na(multreg_pval) ~ .,
TRUE ~ .)) %>%
mutate_at(vars(is_slope_pval, is_slope, is_slope_lower, is_slope_upper, is_DW_stat, is_DW_pval),
~ case_when(iva_pval <0.05 ~ .,
multreg_pval < 0.05 ~ .,
TRUE ~ NA_real_)) %>%
mutate_at(vars(ls_slope_pval, ls_slope, ls_slope_lower, ls_slope_upper, ls_DW_stat, ls_DW_pval),
~ case_when(iva_pval <0.05 ~ .,
multreg_pval < 0.05 ~ .,
TRUE ~ NA_real_)) %>%
mutate_at(vars(alldata_slope, alldata_slope_upper, alldata_slope_lower),
~ case_when(alldata_slope_pval >= 0.05 ~ NA_real_,
TRUE ~ .)) %>%
mutate_at(vars(ls_slope, ls_slope_upper, ls_slope_lower),
~ case_when(ls_slope_pval >= 0.05 ~ NA_real_,
TRUE ~ .)) %>%
mutate_at(vars(is_slope, is_slope_upper, is_slope_lower),
~ case_when(is_slope_pval >= 0.05 ~ NA_real_,
TRUE ~ .))
iva_table_recode
# recode table values where they are irrelevant
iva_table_recode <- iva_table %>%
mutate_at(vars(multreg_pval),
~ case_when(iva_pval <0.05 ~ NA_real_,
TRUE ~ .)) %>%
mutate_at(vars(alldata_slope_pval, alldata_slope, alldata_slope_lower, alldata_slope_upper, alldata_DW_stat, alldata_DW_pval),
~ case_when(multreg_pval <0.05 ~NA_real_,
iva_pval <0.05~NA_real_,
is.na(multreg_pval) ~ .,
TRUE ~ .)) %>%
mutate_at(vars(is_slope_pval, is_slope, is_slope_lower, is_slope_upper, is_DW_stat, is_DW_pval),
~ case_when(iva_pval <0.05 ~ .,
multreg_pval < 0.05 ~ .,
TRUE ~ NA_real_)) %>%
mutate_at(vars(ls_slope_pval, ls_slope, ls_slope_lower, ls_slope_upper, ls_DW_stat, ls_DW_pval),
~ case_when(iva_pval <0.05 ~ .,
multreg_pval < 0.05 ~ .,
TRUE ~ NA_real_)) %>%
mutate_at(vars(alldata_slope, alldata_slope_upper, alldata_slope_lower, alldata_DW_stat, alldata_DW_pval),
~ case_when(alldata_slope_pval >= 0.05 ~ NA_real_,
TRUE ~ .)) %>%
mutate_at(vars(ls_slope, ls_slope_upper, ls_slope_lower, ls_DW_stat, ls_DW_pval),
~ case_when(ls_slope_pval >= 0.05 ~ NA_real_,
TRUE ~ .)) %>%
mutate_at(vars(is_slope, is_slope_upper, is_slope_lower, is_DW_stat, is_DW_pval),
~ case_when(is_slope_pval >= 0.05 ~ NA_real_,
TRUE ~ .))
iva_table_recode
write.csv(iva_table_recode, file.path(figdir, 'TableB_IVA_slope_results.csv'), row.names = F)
write.csv(iva_table_recode, file.path(figdir, 'TableB_IVA_slope_results.csv'), row.names = F)
source('scripts/R_library.R')
figdir = 'figures/'
datadir = 'data/'
lmp <- read.csv('https://raw.githubusercontent.com/Lake-Sunapee-Protective-Association/LMP/main/master%20files/LSPALMP_1986-2020_v2021-03-29.csv')
lmp_temp_deep <- lmp %>%
filter(parameter == 'temp_C') %>%
filter(station == 200 | station ==210 | station == 220| station==230) %>%
filter(depth_m == 0.5)
# load all LS data, filter for freeze and cloud cover
ls <- read.csv(file.path(datadir, 'colab-output/C2/C2_v2_temp_stats.csv')) %>%
mutate(date = substrRight(`system.index`, 8),
date = as.Date(date, format = '%Y%m%d')) %>%
mutate(LSmission = case_when(grepl('LT05', `system.index`) ~ 'LS 5',
grepl('LT04', `system.index`) ~ 'LS 4',
grepl('LE07', `system.index`) ~ 'LS 7',
grepl('LC08', `system.index`) ~ 'LS 8',
TRUE ~ NA_character_))
ls_kurtosis <- ls %>%
filter(surface_temp_kurtosis >2 )
#### whole lake median by month and year ####
lmp_temp_monthly_stats <- lmp_temp_deep %>%
mutate(month = as.numeric(format(as.Date(date), '%m')),
day = as.numeric(format(as.Date(date), '%d')),
year = as.numeric(format(as.Date(date), '%Y'))) %>%
group_by(year, month) %>%
summarise(is_summer_median_temp_degC = median(value),
is_summer_max_temp_degC = max(value),
is_summer_min_temp_degC = min(value),
is_n_obs = length(value),
day = min(day)) %>%
filter((month >=5 & month < 12))
ggplot(lmp_temp_monthly_stats, aes(x=year, y = is_summer_median_temp_degC)) +
facet_grid(.~month) +
geom_point() +
geom_smooth(method = 'lm', se = F)
ls_temp_summer_monthly_median_kurtosis <- ls_kurtosis %>%
mutate(month = as.numeric(format((date), '%m')),
year = as.numeric(format((date), '%Y'))) %>%
group_by(year, month) %>%
summarise(ls_summer_median_temp_degC = median(surface_temp_median),
ls_n_obs = length(surface_temp_median))  %>%
filter(!is.na(month))
ggplot(ls_temp_summer_monthly_median_kurtosis, aes(x=year, y = ls_summer_median_temp_degC)) +
facet_grid(.~month) +
geom_point() +
geom_smooth(method = 'lm', se = F)
df1_med <- lmp_temp_monthly_stats %>%
select(year, month, is_summer_median_temp_degC)
df2_med_kurtosis <- ls_temp_summer_monthly_median_kurtosis %>%
select(year, month, ls_summer_median_temp_degC)
temp_monthly_median <- full_join(df1_med, df2_med_kurtosis) %>%
pivot_longer(., cols = c(ls_summer_median_temp_degC, is_summer_median_temp_degC), names_to='source', values_to = 'value') %>%
mutate(source = case_when(grepl('is_', source) ~ 'in-situ',
grepl('ls_', source) ~ 'landsat',
TRUE ~ NA_character_)) %>%
filter(!is.na(value))
temp_monthly_median %>%
group_by(month) %>%
ggplot(., aes(x = year, y = value)) +
geom_point(aes(color = source)) +
# geom_line(aes(color = source)) +
facet_grid(.~month) +
labs(y = 'lake surface temperature\n(degrees C)') +
# geom_smooth(method = 'lm', se = F, inherit.aes = T) +
final_theme
linear_analysis = function(mm, ds){
data <- temp_monthly_median %>%
filter(month == mm & source == ds)
lm_result <- lm(data$value ~ data$year)
print(lm_result)
}
is_5_lm <- linear_analysis(5, 'in-situ')
is_6_lm <- linear_analysis(6, 'in-situ')
is_7_lm <- linear_analysis(7, 'in-situ')
is_8_lm <- linear_analysis(8, 'in-situ')
is_9_lm <- linear_analysis(9, 'in-situ')
is_10_lm <- linear_analysis(10, 'in-situ')
ls_5_lm <- linear_analysis(5, 'landsat')
ls_6_lm <- linear_analysis(6, 'landsat')
ls_7_lm <- linear_analysis(7, 'landsat')
ls_8_lm <- linear_analysis(8, 'landsat')
ls_9_lm <- linear_analysis(9, 'landsat')
ls_10_lm <- linear_analysis(10, 'landsat')
# do DW test for each month and each dataset
car::durbinWatsonTest(is_5_lm)
car::durbinWatsonTest(is_6_lm)
car::durbinWatsonTest(is_7_lm)
car::durbinWatsonTest(is_8_lm)
car::durbinWatsonTest(is_9_lm)
car::durbinWatsonTest(is_10_lm)
car::durbinWatsonTest(ls_5_lm)
car::durbinWatsonTest(ls_6_lm)
car::durbinWatsonTest(ls_7_lm)
car::durbinWatsonTest(ls_8_lm)
car::durbinWatsonTest(ls_9_lm)
car::durbinWatsonTest(ls_10_lm)
# do DW test for each month and each dataset
DW_table <- NULL
DW_table$month = NA
DW_table$data = NA
DW_table$DW_stat = NA
DW_table$DW_pval = NA
View(DW_table)
# do DW test for each month and each dataset
DW_table <- as.data.frame(NULL)
DW_table$month = NA
# do DW test for each month and each dataset
DW_table <- as.data.frame(NULL) %>%
mutate(month = NA_real_)
DW_table$month = NA_real_
# do DW test for each month and each dataset
DW_table <- as.data.frame(NULL) %>%
mutate(month = NA_real_,
data = NA_real_,
DW_stat = NA_real_,
DW_pval = NA_real_)
DW_table$month = c(5:10)
DW_table$month[1] = '05'
# do DW test for each month and each dataset
monthlist = c(5:10, 5:10)
data = c('in-situ','in-situ','in-situ','in-situ','in-situ',
'landast','landast','landast','landast','landast',)
data = c('in-situ','in-situ','in-situ','in-situ','in-situ',
'landast','landast','landast','landast','landast')
car::durbinWatsonTest(is_5_lm)
dw = car::durbinWatsonTest(is_5_lm)
DW_stat =
car::durbinWatsonTest(is_5_lm)$dw
DW_stat =
(car::durbinWatsonTest(is_5_lm))$dw
DW_stat = c(car::durbinWatsonTest(is_5_lm)$dw,
car::durbinWatsonTest(is_6_lm)$dw,
car::durbinWatsonTest(is_7_lm)$dw,
car::durbinWatsonTest(is_8_lm)$dw,
car::durbinWatsonTest(is_9_lm)$dw,
car::durbinWatsonTest(is_10_lm)$dw,
car::durbinWatsonTest(ls_5_lm)$dw,
car::durbinWatsonTest(ls_6_lm)$dw,
car::durbinWatsonTest(ls_7_lm)$dw,
car::durbinWatsonTest(ls_8_lm)$dw,
car::durbinWatsonTest(ls_9_lm)$dw,
car::durbinWatsonTest(ls_10_lm)$dw)
DW_pval = c(car::durbinWatsonTest(is_5_lm)$p,
car::durbinWatsonTest(is_6_lm)$p,
car::durbinWatsonTest(is_7_lm)$p,
car::durbinWatsonTest(is_8_lm)$p,
car::durbinWatsonTest(is_9_lm)$p,
car::durbinWatsonTest(is_10_lm)$p,
car::durbinWatsonTest(ls_5_lm)$p,
car::durbinWatsonTest(ls_6_lm)$p,
car::durbinWatsonTest(ls_7_lm)$p,
car::durbinWatsonTest(ls_8_lm)$p,
car::durbinWatsonTest(ls_9_lm)$p,
car::durbinWatsonTest(ls_10_lm)$p)
data.frame(monthlist, data, DW_stat, DW_pval)
data = c('in-situ','in-situ','in-situ','in-situ','in-situ','in-situ',
'landast','landast','landast','landast','landast','landast')
DW_stat = c(car::durbinWatsonTest(is_5_lm)$dw,
car::durbinWatsonTest(is_6_lm)$dw,
car::durbinWatsonTest(is_7_lm)$dw,
car::durbinWatsonTest(is_8_lm)$dw,
car::durbinWatsonTest(is_9_lm)$dw,
car::durbinWatsonTest(is_10_lm)$dw,
car::durbinWatsonTest(ls_5_lm)$dw,
car::durbinWatsonTest(ls_6_lm)$dw,
car::durbinWatsonTest(ls_7_lm)$dw,
car::durbinWatsonTest(ls_8_lm)$dw,
car::durbinWatsonTest(ls_9_lm)$dw,
car::durbinWatsonTest(ls_10_lm)$dw)
DW_pval = c(car::durbinWatsonTest(is_5_lm)$p,
car::durbinWatsonTest(is_6_lm)$p,
car::durbinWatsonTest(is_7_lm)$p,
car::durbinWatsonTest(is_8_lm)$p,
car::durbinWatsonTest(is_9_lm)$p,
car::durbinWatsonTest(is_10_lm)$p,
car::durbinWatsonTest(ls_5_lm)$p,
car::durbinWatsonTest(ls_6_lm)$p,
car::durbinWatsonTest(ls_7_lm)$p,
car::durbinWatsonTest(ls_8_lm)$p,
car::durbinWatsonTest(ls_9_lm)$p,
car::durbinWatsonTest(ls_10_lm)$p)
data.frame(monthlist, data, DW_stat, DW_pval)
# do DW test for each month and each dataset
month = c(5:10, 5:10)
data = c('in-situ','in-situ','in-situ','in-situ','in-situ','in-situ',
'landast','landast','landast','landast','landast','landast')
DW_stat = c(car::durbinWatsonTest(is_5_lm)$dw,
car::durbinWatsonTest(is_6_lm)$dw,
car::durbinWatsonTest(is_7_lm)$dw,
car::durbinWatsonTest(is_8_lm)$dw,
car::durbinWatsonTest(is_9_lm)$dw,
car::durbinWatsonTest(is_10_lm)$dw,
car::durbinWatsonTest(ls_5_lm)$dw,
car::durbinWatsonTest(ls_6_lm)$dw,
car::durbinWatsonTest(ls_7_lm)$dw,
car::durbinWatsonTest(ls_8_lm)$dw,
car::durbinWatsonTest(ls_9_lm)$dw,
car::durbinWatsonTest(ls_10_lm)$dw)
DW_pval = c(car::durbinWatsonTest(is_5_lm)$p,
car::durbinWatsonTest(is_6_lm)$p,
car::durbinWatsonTest(is_7_lm)$p,
car::durbinWatsonTest(is_8_lm)$p,
car::durbinWatsonTest(is_9_lm)$p,
car::durbinWatsonTest(is_10_lm)$p,
car::durbinWatsonTest(ls_5_lm)$p,
car::durbinWatsonTest(ls_6_lm)$p,
car::durbinWatsonTest(ls_7_lm)$p,
car::durbinWatsonTest(ls_8_lm)$p,
car::durbinWatsonTest(ls_9_lm)$p,
car::durbinWatsonTest(ls_10_lm)$p)
DW_table = data.frame(monthlist, data, DW_stat, DW_pval)
View(lmp_temp_monthly_stats)
linear_analysis_all = function(mm){
data <- temp_monthly_median %>%
filter(month == mm)
lm_result <- lm(data$value ~ data$year)
print(lm_result)
}
all_5_lm <- linear_analysis_all(5)
all_6_lm <- linear_analysis_all(6)
all_7_lm <- linear_analysis_all(7)
all_8_lm <- linear_analysis_all(8)
all_9_lm <- linear_analysis_all(9)
all_10_lm <- linear_analysis_all(10)
all_11_lm <- linear_analysis_all(11)
linear_analysis = function(mm, ds){
data <- temp_monthly_median %>%
filter(month == mm & source == ds)
lm_result <- lm(data$value ~ data$year)
print((lm_result))
}
is_5_lm <- linear_analysis(5, 'in-situ')
is_6_lm <- linear_analysis(6, 'in-situ')
is_7_lm <- linear_analysis(7, 'in-situ')
is_8_lm <- linear_analysis(8, 'in-situ')
is_9_lm <- linear_analysis(9, 'in-situ')
is_10_lm <- linear_analysis(10, 'in-situ')
ls_5_lm <- linear_analysis(5, 'landsat')
ls_6_lm <- linear_analysis(6, 'landsat')
ls_7_lm <- linear_analysis(7, 'landsat')
ls_8_lm <- linear_analysis(8, 'landsat')
ls_9_lm <- linear_analysis(9, 'landsat')
ls_10_lm <- linear_analysis(10, 'landsat')
# indicator variable analysis ####
temp_monthly_median$source = as.factor(temp_monthly_median$source)
source_contrasts <- contrasts(temp_monthly_median$source)
may_data <- temp_monthly_median %>%
filter(month == 5)
jun_data <- temp_monthly_median %>%
filter(month == 6)
jul_data <- temp_monthly_median %>%
filter(month == 7)
aug_data <- temp_monthly_median %>%
filter(month == 8)
sep_data <- temp_monthly_median %>%
filter(month == 9)
oct_data <- temp_monthly_median %>%
filter(month == 10)
nov_data <- temp_monthly_median %>%
filter(month == 11)
## MAY ####
lm_source_may_iva <- lm(value ~ year+source+year*source, data = may_data)
summary(lm_source_may_iva)
## MAY ####
lm_source_may_iva <- lm(value ~ year+source+year*source, data = may_data)
summary(lm_source_may_iva)
#no sig diff in slope
lm_source_may <- lm(value ~ year+source, data = may_data)
summary(lm_source_may)
#difference in intercept
is_5_lm
ls_5_lm
#difference in intercept
summary(is_5_lm)
#no sig diff in intercept
summary(all_6_lm)
## JUN ####
lm_source_jun_iva <- lm(value ~ year+source+year*source, data = jun_data)
summary(lm_source_jun_iva)
#no sig diff in slope
lm_source_jun <- lm(value ~ year+source, data = jun_data)
summary(lm_source_jun)
#no sig diff in intercept
summary(all_6_lm)
## JULY ####
lm_source_jul_iva <- lm(value ~ year+source+year*source, data = jul_data)
summary(lm_source_jul_iva)
# no sig diff in slope; intercept and slope are sig
lm_source_jul <- lm(value ~ year+source, data = jul_data)
summary(lm_source_jul)
## AUG ####
lm_source_aug_iva <- lm(value ~ year+source+year*source, data = aug_data)
summary(lm_source_aug_iva)
# no sig diff in slope
lm_source_aug <- lm(value ~ year+source, data = aug_data)
summary(lm_source_aug)
#no sig diff in intercept; intercept and slope sig
summary(all_8_lm)
## SEPT ####
lm_source_sep_iva <- lm(value ~ year+source+year*source, data = sep_data)
summary(lm_source_sep_iva)
# there is a significant difference in slope
lm_source_sep <- lm(value ~ year+source, data = sep_data)
summary(lm_source_sep)
summary(is_9_lm)
summary(ls_9_lm)
#plot one line for landsat
ls_9_data <- sep_data %>%
filter(source == 'landsat')
## OCT ####
lm_source_oct_iva <- lm(value ~ year+source+year*source, data = oct_data)
summary(lm_source_oct_iva)
#no diff in slope
lm_source_oct <- lm(value ~ year+source, data = oct_data)
summary(lm_source_oct)
#no diff in intercept
summmary(all_10_lm)
#no diff in intercept
summary(all_10_lm)
write.csv(DW_table, file.path(datadir, 'DW_table_ISLS_monthly.csv'), row.names = F)
DW_table = data.frame(monthlist, data, DW_stat, DW_pval) %>%
mutate(DW_stat = round(DW_stat, digits = 3),
DW_pval = round(DW_pval, digits = 3))
write.csv(DW_table, file.path(datadir, 'DW_table_ISLS_monthly.csv'), row.names = F)
write.csv(DW_table, file.path(datadir, 'DW_table_ISLS_monthly.csv'), row.names = F)
write.csv(DW_table, file.path(figdir, 'STD_DW_table_ISLS_monthly.csv'), row.names = F)
write.csv(iva_table_recode, file.path(figdir, 'STE_IVA_slope_results.csv'), row.names = F)
write.csv(iva_table, file.path(figdir, 'STE_IVA_slope_results.csv'), row.names = F)
# IVA results to table ####
iva_table <- NULL
iva_table$month <- c('May', 'June', 'July', 'August', 'September', 'October')
iva_table$iva_pval <- c(summary(lm_source_may_iva)$coefficients[4,4],
summary(lm_source_jun_iva)$coefficients[4,4],
summary(lm_source_jul_iva)$coefficients[4,4],
summary(lm_source_aug_iva)$coefficients[4,4],
summary(lm_source_sep_iva)$coefficients[4,4],
summary(lm_source_oct_iva)$coefficients[4,4])
iva_table$multreg_pval <- c(summary(lm_source_may)$coefficients[3,4],
summary(lm_source_jun)$coefficients[3,4],
summary(lm_source_jul)$coefficients[3,4],
summary(lm_source_aug)$coefficients[3,4],
summary(lm_source_sep)$coefficients[3,4],
summary(lm_source_oct)$coefficients[3,4])
iva_table <- as.data.frame(iva_table)
iva_table <- iva_table %>%
mutate_at(vars(iva_pval, multreg_pval),
~ round(., digits = 3))
write.csv(iva_table, file.path(figdir, 'STE_IVA_slope_results.csv'), row.names = F)
