theme(legend.position = 'none')
sept <- temp_monthly_median %>%
filter(month == 9) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
geom_abline(slope = ls_9_lm$coefficients[2, 1],
intercept = ls_9_lm$coefficients[1,1],
color = "#E69F00") +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1985, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'September') +
theme(legend.position = 'none')
oct <- temp_monthly_median %>%
filter(month == 10) %>%
ggplot(., aes(x = year, y = value))+
geom_point(aes(color = source)) +
geom_abline(slope = ls_10_lm$coefficients[2, 1],
intercept = ls_10_lm$coefficients[1,1],
color = "#E69F00") +
final_theme +
coord_cartesian(ylim = c(7, 27),
xlim = c(1985, 2020)) +
scale_color_colorblind() +
labs(x = NULL, y = NULL, title = 'October') +
theme(legend.position = 'none')
#set up png device
png(file.path(figdir, 'application_monthly_median_temp_together.png'),
width=8,height=6, units = 'in', res = 300)
gridExtra::grid.arrange(may, june, jul, aug, sept, oct,
nrow = 2,
left = 'lake surface temperature\ndegrees C',
bottom = '    = in-situ        = landsat')
#Close pdf graphics device
dev.off()
#set up png device
png(file.path(figdir, 'application_monthly_median_temp_together.png'),
width=8,height=6, units = 'in', res = 300)
gridExtra::grid.arrange(may, june, jul, aug, sept, oct,
nrow = 2,
left = 'lake surface temperature\ndegrees C',
bottom = 'black = in-situ   yellow = landsat')
#Close pdf graphics device
dev.off()
is_7_lm <- linear_analysis(7, 'in-situ')
ls_7_lm <- linear_analysis(7, 'landsat')
is_8_lm <- linear_analysis(8, 'in-situ')
ls_9_lm <- linear_analysis(9, 'landsat')
ls_10_lm <- linear_analysis(10, 'landsat')
knitr::opts_chunk$set(echo = TRUE)
source('R_library.R')
dir = '~/GitHub/ids-ne-lakes/'
datadir = '~/GitHub/ids-ne-lakes/data/'
figdir = '~/GitHub/ids-ne-lakes/figures/'
knitr::opts_chunk$set(echo = TRUE)
source('R_library.R')
dir = '~/GitHub/ids-ne-lakes/'
datadir = '~/GitHub/ids-ne-lakes/data/'
figdir = '~/GitHub/ids-ne-lakes/figures/'
#load in all insitu data for historical data analysis
insitu <- read.csv(paste0(datadir, 'insitu_temp_data_v2021-05-17.csv')) %>%
filter(!is.na(lat_dd)) %>%
mutate(datetime = as.POSIXct(datetime, tz='Etc/GMT+5')) %>%
filter(format(datetime, '%m') < 11)
#read in all skin temp data for whole lake
lst_all <- read_csv(paste0(datadir, 'colab-output/2021-06-08/sunapee_temp_stats.csv'),
col_types = c('')) %>%
mutate(date =as.Date(substrRight(`system:index`, 8), '%Y%m%d'),
month = as.numeric(format(date, '%m')),
year = as.factor(format(date, '%Y')),
doy = as.numeric(format(date, '%j')),
LSmission = case_when(grepl('LT04', `system:index`) ~ 'LS 4',
grepl('LT05', `system:index`) ~ 'LS 5',
grepl('LE07', `system:index`) ~ 'LS 7',
grepl('LC08', `system:index`) ~ 'LS 8')) %>%
filter(month < 11) %>%
mutate(month = as.factor(month))
lst_all %>%
group_by(LSmission) %>%
summarize(count = length(LSmission))
lst_paired <- read_csv(paste0(datadir, 'colab-output/2021-06-08/sunapee_insitu_landsat_paired.csv'),
col_types = c('')) %>%
mutate(date =as.Date(substrRight(`system:index`, 8), '%Y%m%d')) %>%
filter(as.numeric(format(date, '%m')) < 11)
#load in the matched insitu data .csvs
#make a list of the file namesin the folder
match_names <- list.files(paste0(datadir, 'colab-output/2021-06-08/ancillary'))
#iterate over the files into a dataframe
for(i in 1:length(match_names)) {
data <- read_csv(paste0(datadir, 'match-files/', match_names[i]),
col_types = c('')) %>%
mutate(source = paste0(match_names[i]))
if (i == 1) {
match_details <- data
} else {
match_details <- full_join(match_details, data)
}
}
# add columns for match_details
match_details <- match_details %>%
mutate(date =as.Date(datetime),
month = as.numeric(format(date, '%m')),
year = as.factor(format(date, '%Y')),
doy = as.numeric(format(date, '%j'))) %>%
filter(frequency == 'sub-daily') %>%
filter(month < 11) %>%
mutate(month = as.factor(month))
#read in the modal information
modal_analysis <- read.csv(file.path(datadir, 'colab-output/2021-06-08/date_modalanalysis.csv')) %>%
mutate(date = as.Date(date))
#read in binned data
lst_hist <- read.csv(file.path(datadir, 'colab-output/2021-06-08/sunapee_histograms_0p1bin_reformatted.csv')) %>%
mutate(date = as.Date(date))
#number of observations for total DB
insitu %>%
summarize(nobs = length(datetime),
ndays = length(unique(format(datetime, '%Y-%m-%d'))),
year_start = min(as.numeric(format(datetime, '%Y'))),
year_end = max(as.numeric(format(datetime, '%Y'))),
min_month = min(as.numeric(format(datetime, '%m'))),
max_month = max(as.numeric(format(datetime, '%m'))),
nsites = length(unique(location)))
#number of observations between time of 9 and 11
insitu %>%
mutate(hour = as.numeric(format(datetime, '%H'))) %>%
filter(hour >= 9 & hour < 11) %>%
summarize(nobs = length(datetime),
ndays = length(unique(format(datetime, '%Y-%m-%d'))),
year_start = min(as.numeric(format(datetime, '%Y'))),
year_end = max(as.numeric(format(datetime, '%Y'))),
min_month = min(as.numeric(format(datetime, '%m'))),
max_month = max(as.numeric(format(datetime, '%m'))),
nsites = length(unique(location)))
#number of sites
length(unique(insitu$location))
unique(insitu$location)
#document max spread for LST
range_per_date <- insitu %>%
mutate(hour = as.numeric(format(datetime, '%H')),
date = as.Date(datetime)) %>%
filter(hour >= 9 & hour < 11) %>%
group_by(date) %>%
summarize(temp_range = max(temp_degC) - min(temp_degC),
IQR = IQR(temp_degC, na.rm = T),
n_locs = length(unique(location)))
max_spread <- max(range_per_date$temp_range, na.rm = T)
max_IQR <- max(range_per_date$IQR, na.rm = T)
range_summary <- range_per_date %>%
mutate(month = as.numeric(format(date, '%m'))) %>%
group_by(month) %>%
filter(n_locs >3) %>%
summarise(min_range = min(temp_range, na.rm = T),
max_range = max(temp_range, na.rm = T))
insitu %>%
mutate(year = format(datetime, '%Y'),
month = as.numeric(format(datetime, '%m'))) %>%
group_by(year, location) %>%
summarise(min_depth_m = min(depth_m),
max_depth_m = max(depth_m),
min_month = min(month),
max_month = max(month)) %>%
pivot_longer(!c(year, location), names_to = 'variable', values_to = 'value') %>%
pivot_wider(id_cols = c(year, variable, value),
names_from = c(location, variable)) %>%
write.csv(., file.path(datadir, 'insitu_data_extent_summary.csv'), row.names = F)
lst_filt_freeze <- lst_all %>%
filter(surface_temp_min > 0)
lst_filt_mod <- lst_filt_freeze %>%
left_join(., modal_analysis) %>%
filter(unimodal == 'unimodal')
lst_filt_maxrange <- lst_filt_mod %>%
mutate(temp_spread = round(surface_temp_max, digits = 1) - round(surface_temp_min, digits = 1)) %>%
filter(temp_spread < max_spread*1.1)
lst_filt_maxIQR <- lst_filt_mod %>%
mutate(IQR = round(surface_temp_p75, digits = 1) - round(surface_temp_p25, digits = 1))  %>%
filter(IQR < IQR*1.1)
lst_filt_maxrange %>%
group_by(LSmission) %>%
summarize(count = length(LSmission))
colnames(lst_filt_maxrange)
ggplot(lst_all, aes(x = pct_lake, y = (surface_temp_max-surface_temp_min))) +
geom_point(aes(color = month)) +
labs(y = 'temp_spread')+
final_theme
ggsave(file.path(figdir, 'tempspread by pct lake by month summary.png'))
ggplot(lst_filt_maxrange, aes(x = pct_lake, y = temp_spread)) +
geom_point(aes(color = month)) +
final_theme
ggsave(file.path(figdir, 'filtered tempspread by pct lake by month summary.png'))
#inner join with unimodal data and 25% of lake
match_details_filt <- match_details %>%
mutate(date = as.Date(date)) %>%
inner_join(., modal_analysis) %>%
inner_join(., lst_filt_maxrange) %>%
filter(unimodal == 'unimodal' & perc_lake > 25)
#number of observations where there is a match with LS data
match_details_filt %>%
summarize(nobs = length(datetime),
ndays = length(unique(format(datetime, '%Y-%m-%d'))),
year_start = min(as.numeric(format(datetime, '%Y'))),
year_end = max(as.numeric(format(datetime, '%Y'))))
length(unique(match_details_filt$location))
buoy_data_summary_flyover <- insitu %>%
filter(location == 'loon') %>%
mutate(hour = as.numeric(format(datetime, '%H')),
year = as.factor(format(datetime, '%Y')),
day = as.factor(format(datetime, '%d'))) %>%
filter(hour >=9 & hour <11)
QC_check <- buoy_data_summary_flyover %>%
group_by(month, year) %>%
summarise(ndays = length(unique(day))) %>%
filter(ndays >= 15)
buoy_data_summary_flyover <- buoy_data_summary_flyover %>%
right_join(., QC_check)
ggplot(buoy_data_summary_flyover, aes(x = month, y = temp_degC, fill = year)) +
geom_boxplot(aes(group = paste(year, month))) +
final_theme +
scale_x_continuous(breaks = c(5, 6,7,8,9,10,11), labels = c('May', 'Jun', 'Jul', 'Aug', 'Sept', 'Oct', 'Nov')) +
scale_y_continuous(n.breaks = 8) +
labs(y = 'water temperature (deg C)')
ggsave(paste0(figdir, 'water_temp_buoy_interannual_v29June2021.png'), width = 8, height = 4, units = 'in')
insitu_2018 <- insitu %>%
mutate(year = as.numeric(format(datetime, '%Y'))) %>%
filter(year == 2018)%>%
mutate(hour = as.numeric(format(datetime, '%H')),
year = as.factor(format(datetime, '%Y')),
day = as.factor(format(datetime, '%d'))) %>%
filter(hour >=9 & hour <11)
QC_check_2018 <- insitu_2018 %>%
group_by(month, year, location) %>%
summarise(ndays = length(unique(day))) %>%
filter(ndays >= 15)
insitu_2018 <- insitu_2018 %>%
right_join(., QC_check_2018) %>%
mutate(location = as.factor(location)) %>%
filter(month >=6 & month <10) #filter for months that have multiple locations
unique(insitu_2018$location)
insitu_2018 <- insitu_2018 %>%
mutate(location_long = case_when(location == 'loon' ~ 'primary (LSPA/GLEON) buoy',
location == 'GeorgesMills' ~ 'Georges Mills buoy',
location == 'HerrickCove' ~ 'Herrick Cove buoy',
location == 'StateBeach' ~ 'State Beach buoy',
location == 'HerrickCoveSouth' ~ 'Herrick Cove near-shore',
location == 'Newbury' ~ 'Newbury near-shore',
location == 'NorthSunapeeHarbor' ~ 'North Sunapee Harbor near-shore',
location == 'SouthOfTheFells' ~ 'South of the Fells near-shore'),
location_long = factor(location_long, levels = c('primary (LSPA/GLEON) buoy','Georges Mills buoy','Herrick Cove buoy','State Beach buoy','Herrick Cove near-shore','Newbury near-shore','North Sunapee Harbor near-shore','South of the Fells near-shore'), ordered = T)) %>%
arrange(location_long)
ggplot(insitu_2018, aes(x = month, y = temp_degC, fill = location_long)) +
geom_boxplot(aes(group = paste(location_long, month)))  +
scale_x_continuous(breaks = c(6,7,8,9), labels = c('Jun', 'Jul', 'Aug', 'Sept')) +
scale_y_continuous(n.breaks = 8) +
labs(y = 'water temperature (deg C)') +
labs(fill = 'location') +
theme(legend.spacing.y = unit(0.1, 'cm')) +
guides()+
final_theme
ggsave(paste0(figdir, 'water_temp_2018_crosssite_v29June2021.png'), width = 8, height = 4, units = 'in')
lst_filt_mod_select_range <- lst_filt_maxrange %>%
select(date:temp_spread)
lst_filt_mod_select_IQR <- lst_filt_maxIQR %>%
select(date:IQR)
validation_range <- lst_paired %>%
mutate(date = as.Date(substrRight(scene, 8), '%Y%m%d')) %>%
inner_join(., lst_filt_mod_select_range)
validation_IQR <- lst_paired %>%
mutate(date = as.Date(substrRight(scene, 8), '%Y%m%d')) %>%
inner_join(., lst_filt_mod_select_IQR)
val_mean_ls <- lm(validation_range$surface_temp_median ~ validation_range$temp_med)
summary(val_mean_ls)
val_mean_dem <-deming::deming(validation_range$surface_temp_median ~ validation_range$temp_med)
val_mean_dem
cor(validation_range$surface_temp_median, validation_range$temp_med)
ggplot(validation_range, aes(x = temp_med, y = surface_temp_median)) +
geom_point() +
geom_abline(intercept = val_mean_dem$coefficients[1], slope = val_mean_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem$ci[1,1], slope = val_mean_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem$ci[1,2], slope = val_mean_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(7,27),
ylim = c(7,27)) +
labs(y = 'satellite-derived median\nskin temperature (deg C)',
x = expression(paste(italic('in-situ'), ' median water temp (deg C)'))) +
final_theme
ggsave(paste0(figdir, 'deming_reg_median_v28June2021.jpg'), height = 5, width = 5, units = 'in')
validation_range$pred_temp = val_mean_dem$coefficients[1] + val_mean_dem$coefficients[2]*validation_range$temp_med
lst_insitu_dem_forresid = mcreg(x = validation_range$temp_med, y = validation_range$surface_temp_median, method.reg = 'Deming')
validation_range$opt_resid = MCResult.getResiduals(lst_insitu_dem_forresid)$optimized
#plot to make sure prediction is correct
ggplot(validation_range, aes(x = temp_med, y = pred_temp))+
geom_point(color = 'blue') +
geom_point(aes(x = temp_med, y = surface_temp_median))
lst_filt_maxrange <- lst_filt_maxrange %>%
mutate(calib_med_temp_degC = (surface_temp_median-val_mean_dem$coefficients[1])/val_mean_dem$coefficients[2])
lst_filt_maxrange %>%
select(date, LSmission, temp_spread, pct_lake, surface_temp_count:surface_temp_stdDev, calib_med_temp_degC) %>%
write.csv(file.path(datadir, 'LS_passQAQC_v19July2021.csv'), row.names = F)
#plot to make sure calibration is correct
lst_filt_mod_select_range_calib <- lst_filt_maxrange %>%
select(date:temp_spread, calib_med_temp_degC)
validation_range_calib <- lst_paired %>%
mutate(date = as.Date(substrRight(scene, 8), '%Y%m%d')) %>%
inner_join(., lst_filt_mod_select_range_calib)
ggplot(validation_range_calib, aes(x = temp_med, y = surface_temp_median)) +
geom_point() +
geom_point(aes(x = temp_med, y = calib_med_temp_degC), color = 'red')+
geom_abline(intercept = val_mean_dem$coefficients[1], slope = val_mean_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem$ci[1,1], slope = val_mean_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem$ci[1,2], slope = val_mean_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(7,27),
ylim = c(7,27)) +
labs(y = 'satellite-derived median\nskin temperature (deg C)',
x = expression(paste(italic('in-situ'), ' median water temp (deg C)'))) +
final_theme
val_mean_ls <- lm(validation_IQR$surface_temp_median ~ validation_IQR$temp_med)
summary(val_mean_ls)
val_mean_dem <-deming::deming(validation_IQR$surface_temp_median ~ validation_IQR$temp_med)
val_mean_dem
cor(validation_IQR$surface_temp_median, validation_IQR$temp_med)
ggplot(validation_IQR, aes(x = temp_med, y = surface_temp_median)) +
geom_point() +
geom_abline(intercept = val_mean_dem$coefficients[1], slope = val_mean_dem$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem$ci[1,1], slope = val_mean_dem$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem$ci[1,2], slope = val_mean_dem$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(7,27),
ylim = c(7,27)) +
labs(y = 'satellite-derived median\nskin temperature (deg C)',
x = expression(paste(italic('in-situ'), ' median water temp (deg C)'))) +
final_theme
ggsave(paste0(figdir, 'deming_reg_median_IQR_v19Jul2021.jpg'), height = 5, width = 5, units = 'in')
validation_IQR$pred_temp = val_mean_dem$coefficients[1] + val_mean_dem$coefficients[2]*validation_IQR$temp_med
lst_insitu_dem_forresid = mcreg(x = validation_IQR$temp_med, y = validation_IQR$surface_temp_median, method.reg = 'Deming')
validation_IQR$opt_resid = MCResult.getResiduals(lst_insitu_dem_forresid)$optimized
#plot to make sure prediction is correct
ggplot(validation_IQR, aes(x = temp_med, y = pred_temp))+
geom_point(color = 'blue') +
geom_point(aes(x = temp_med, y = surface_temp_median))
validtion_50 <- validation %>%
filter(perc_lake > 50)
validtion_60 <- validation %>%
filter(perc_lake > 60)
validtion_50 <- validation_range %>%
filter(perc_lake > 50)
validtion_50 <- validation_range %>%
filter(perc_lake > 50)
val_mean_ls_50 <- lm(validtion_50$surface_temp_median ~ validtion_50$temp_med)
summary(val_mean_ls_50)
val_mean_dem_50 <-deming::deming(validtion_50$surface_temp_median ~ validtion_50$temp_med)
val_mean_dem_50
cor(validtion_50$surface_temp_median, validtion_50$temp_med)
ggplot(validtion_50, aes(x = temp_med, y = surface_temp_median)) +
geom_point() +
geom_abline(intercept = val_mean_dem_50$coefficients[1], slope = val_mean_dem_50$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem_50$ci[1,1], slope = val_mean_dem_50$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem_50$ci[1,2], slope = val_mean_dem_50$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(7,27),
ylim = c(7,27)) +
labs(y = 'satellite-derived median\nskin temperature (deg C)',
x = expression(paste(italic('in-situ'), ' median water temp (deg C)'))) +
final_theme
ggsave(paste0(figdir, 'deming_reg_median_50perc_v28June2021.jpg'), height = 5, width = 5, units = 'in')
validtion_60 <- validation_range %>%
filter(perc_lake > 60)
val_mean_ls_60 <- lm(validtion_60$surface_temp_median ~ validtion_60$temp_med)
summary(val_mean_ls_60)
val_mean_dem_60 <-deming::deming(validtion_60$surface_temp_median ~ validtion_60$temp_med)
val_mean_dem_60
cor(validtion_60$surface_temp_median, validtion_60$temp_med)
ggplot(validtion_60, aes(x = temp_med, y = surface_temp_median)) +
geom_point() +
geom_abline(intercept = val_mean_dem_60$coefficients[1], slope = val_mean_dem_60$coefficients[2], color = 'blue') +
geom_abline(intercept = val_mean_dem_60$ci[1,1], slope = val_mean_dem_60$ci[2,1], color = 'blue', linetype = 2) +
geom_abline(intercept = val_mean_dem_60$ci[1,2], slope = val_mean_dem_60$ci[2,2], color = 'blue', linetype = 2) +
geom_abline(intercept = 0, slope = 1) +
coord_cartesian(xlim = c(7,27),
ylim = c(7,27)) +
labs(y = 'satellite-derived median\nskin temperature (deg C)',
x = expression(paste(italic('in-situ'), ' median water temp (deg C)'))) +
final_theme
ggsave(paste0(figdir, 'deming_reg_median_60perc_v28June2021.jpg'), height = 5, width = 5, units = 'in')
# calculate mse with optomized residuals
#all data
validation_range %>%
summarise(mse = round(sum((opt_resid^2))/n(), digits = 2),
rmse = round(sqrt(mse), digits = 2),
bias = round(sum(opt_resid)/n(), digits = 2),
mae = round(sum(abs(opt_resid))/n(), digits = 2),
n_obs = n()) %>%
write.csv(., file.path(datadir, 'LS_deming_prediction_stats_v20Jul2021.csv'))
#all data
validation_range %>%
group_by(LSmission) %>%
summarise(mse = round(sum((opt_resid^2))/n(), digits = 2),
rmse = round(sqrt(mse), digits = 2),
bias = round(sum(opt_resid)/n(), digits = 2),
mae = round(sum(abs(opt_resid))/n(), digits = 2),
n_obs = n()) %>%
write.csv(., file.path(datadir, 'LS_deming_prediction_bymission_stats_v20Jul2021.csv'))
# by month
validation_range %>%
mutate(month = as.numeric(format(date, '%m'))) %>%
group_by(month) %>%
summarise(mse = round(sum((opt_resid^2))/n(), digits = 2),
rmse = round(sqrt(mse), digits = 2),
bias = round(sum(opt_resid)/n(), digits = 2),
mae = round(sum(abs(opt_resid))/n(), digits = 2),
n_obs = n()) %>%
select(month, n_obs, mae, rmse, bias) %>%
write.csv(., file.path(datadir, 'LS_deming_prediction_stats_allmissions_v29June2021.csv'))
#by month and mission
validation_range %>%
mutate(month = as.numeric(format(date, '%m'))) %>%
group_by(month, LSmission) %>%
summarise(mse = round(sum((opt_resid^2))/n(), digits = 2),
rmse = round(sqrt(mse), digits = 2),
bias = round(sum(opt_resid)/n(), digits = 2),
mae = round(sum(abs(opt_resid))/n(), digits = 2),
n_obs = n())  %>%
select(month, LSmission, n_obs, mae, rmse, bias) %>%
pivot_longer(!c(month, LSmission), names_to = 'variable', values_to = 'values') %>%
mutate(variable = factor(variable, levels = c('n_obs', 'mae', 'rmse', 'bias'))) %>%
arrange(month, variable) %>%
pivot_wider(id_cols = c(LSmission,  values, variable),
names_from = c(month, variable),
values_from = values) %>%
arrange(LSmission) %>%
write.csv(., file.path(datadir, 'LS_deming_prediction_stats_v29June2021.csv'))
lst_insitu_dem_forresid = mcreg(x = validation_range$temp_med, y = validation_range$surface_temp_median, method.reg = 'Deming')
ggplot(validation_range, aes(sample = opt_resid)) +
geom_qq() +
geom_qq_line()
ggplot(validation_range, aes (y = opt_resid, x = temp_med)) +
geom_point() +
labs(x = 'in-situ mean water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_x_v28Jun2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation_range, aes (y = opt_resid, x = temp_med, color = month)) +
geom_point(size = 2) +
labs(x = 'in-situ mean water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_x_colorbymonth_v28Jun2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation_range, aes (y = opt_resid, x = cloud_cover)) +
geom_point() +
labs(x = 'cloud cover (percent)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_cloudcover_v28Jun2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation_range, aes (y = opt_resid, x = cloud_cover, color = month)) +
geom_point(size = 2) +
labs(x = 'cloud cover (percent)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_cloudcover_colorbymonth_v28Jun2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation_range, aes (y = opt_resid, x = temp_med)) +
geom_point() +
labs(x = 'in-situ median water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_x_v28Jun2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation_range, aes (y = opt_resid, x = temp_med, color = month)) +
geom_point(size = 2) +
labs(x = 'in-situ median water temp (deg C)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme +
scale_color_colorblind()
ggsave(paste0(dir, 'figures/optresid_x_colorbymonth_v28Jun2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation_range, aes (y = opt_resid, x = azimuth)) +
geom_point() +
labs(x = 'azimuth (degrees)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggsave(paste0(dir, 'figures/optresid_azimuth_v28Jun2021.jpg'), height = 5, width = 8, units = 'in')
ggplot(validation_range, aes (y = opt_resid, x = elev)) +
geom_point() +
labs(x = 'azimuth (degrees)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation_range, aes (y = opt_resid, x = azimuth)) +
geom_point() +
labs(x = 'azimuth (degrees)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
ggplot(validation_range, aes (y = opt_resid, x = azimuth)) +
geom_point() +
labs(x = 'azimuth (degrees)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
View(validation_range)
ggplot(validation_range, aes (y = opt_resid, x = sza)) +
geom_point() +
labs(x = 'azimuth (degrees)',
y = 'deming optimized residuals (deg C)') +
geom_hline(yintercept = 0, color = 'black') +
final_theme
